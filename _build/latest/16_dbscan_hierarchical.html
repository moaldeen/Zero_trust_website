

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>DBSCAN &#8212; ECE 4420/6420 - latest</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"08a6b567fdc54b13a5d0344faad53bf3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "12591820340f447587cd44e360a958e9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "18c287d0964540f6b214925dbec1a0d2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2231c2db13be40e1a1042bfe699fe32f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "26ae9e383e374781b58264fe72663a95": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "29d75ee04dba466fb68e16eba629e2d7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": [], "layout": "IPY_MODEL_78d876e827c24304a2151e550cc8a030"}}, "3c3ff4e1f80546d1924df6bcdd3fc568": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "IntSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "min_samples", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_18c287d0964540f6b214925dbec1a0d2", "max": 5, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ede3ca6ae23444d4b9cb29442bdf7725", "value": 1}}, "40691fb0994d410f94d214560f8a3756": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_26ae9e383e374781b58264fe72663a95", "msg_id": "", "outputs": []}}, "5919027be61b4307a65cc1ea6d7679cf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "59c05574cb424aba9f2f50a6249ee4ba": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "78d876e827c24304a2151e550cc8a030": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8222eafec5ff43e08c7cb0e69671e424": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "IntSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "eps", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f4fd2523204a407ead0213687a140d87", "max": 12, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b8c767a170f84ed4975f3b58f14681db", "value": 1}}, "8d0e1c0c1822422f9389b47204e76564": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "IntSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_18c287d0964540f6b214925dbec1a0d2", "max": 5, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ede3ca6ae23444d4b9cb29442bdf7725", "value": 3}}, "8fafc55f86d7418e921341d6b1f77b0d": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_26ae9e383e374781b58264fe72663a95", "msg_id": "", "outputs": [{"data": {"image/png": "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\n", "text/plain": "<Figure size 640x480 with 1 Axes>"}, "metadata": {}, "output_type": "display_data"}]}}, "916d40663c95429a8883619da0a48821": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2231c2db13be40e1a1042bfe699fe32f", "msg_id": "", "outputs": [{"data": {"image/png": "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8vPz8emnn+Ly5cu4ffs2fvnlF+N4tBkzZuDixYuwsrLCrFmzcPr0ady8eRNXr17FL7/8gk8//RSPPvpohR4jogYjdnKi5uneHhdBEIQ///xTsLKyEgAIc+bMqdC+MXtcAAgfffRRpeXFxcVCx44dBQCCtbW14OnpKdy6datSu+joaON2/vrrrxr388orr1RZ55w5c4xtvvnmmwrLCgsLjT09zz77rFBaWlrlNt5//30BgODm5iYUFBRUWHb3t95+/foJxcXFVW6jLs6cOWPcVnBwsFBWVlapTVJSkrHN9OnTKy2/+/db32/h5eXlgp+fnwBAcHZ2Fv78889q2977npm7xyUkJEQAIPTq1UsoLy835WXVad+CIAhvv/22AEBwcXGp1LNlcObMGUEulwsAhMTExArL7v4d2NnZCadPn652X66urgIA4Z133jHptQgCe1zo/rHHhSyGn58fxo4dCwBYvXo1bt++LUodXl5eiIyMrPS8nZ0dQkJCANwZRzB37ly0bt26UrsxY8YYv2meOHGi2v3I5XKsWLGiymUffPAB3N3dAaBSj8k333yDGzduwMbGBv/73/9gY1P1dEwffPAB7O3tcevWLezZs6faOlasWAE7O7tql9cmJiYGAGBtbY3PPvsMVlaV/1kJCQnB8OHDAQBfffVVjd/262vPnj24cOECgDtXqPn5+VXbtrr3zFz0ej0AoH379mbphcjPzzf+HmbOnInu3btX2a5nz5546aWXAACbNm2qdnuvvvoq/P39q11ueD0dOnQwudb169dDEAQIgsBLmKleGFzIosybNw82NjbQ6XRYtmyZKDUMHToU1tbWVS4zdJUDd06JVMXJyQlubm4AgIyMjGr3M3DgQLi6ula5zM7Ozjhg+ejRoxUO9Hv37gVw5yDk6OiIvLy8Kh/l5eXGA9ivv/5a5X6USiUef/zxamusi0OHDgG4c4lq+/btq233wgsvAABycnJw7ty5+9pnVfbv3w/gToC6+xSKJTCEgB9++AFr165t8Mv+jxw5YhwIO3jw4Go/E3l5eXj44YcBVP+ZAICRI0fWuD/D61mxYgXUarVZgihRdRhcyKJ06dLFOD5j7dq1yMzMbPQa2rVrV+2yu+cUqUu7mg5QNfUIAMADDzwA4M7kbHf3PhmuiDl16hQcHR1rfPz2228AgFu3blW5j06dOtVYQ11c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oqZPtB4Xc2CPCxERkfRIoseFiIiIyFQMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZDC5EREQkGQwuREREJBkMLkRERCQZogSX+fPnQyaT1fro2LGjGOURERGRhbIRY6deXl548sknq11+9uxZ5OXlISAgoBGrIiIiIksnEwRBELuIu+l0OrRt2xaFhYXYtWsXRowYUed1tVotFAoFcnNz4eTkZMYqiYiIqKGYcvy2uDEu3333HQoLC9G2bVs8/fTTYpdDREREFsTigsuGDRsAAC+99BJsbEQ5k0VEREQWyqKCy/Xr13Hw4EEAwPjx40WuhoiIiCyNRXVpbNq0CeXl5XjggQfQu3fvWtsXFxejuLjY+LNWqzVneURERCQyi+px2bhxI4C697YsXboUCoXC+PD09DRneURERCQyi7mq6MyZM+jVqxesrKyQmppapxBSVY+Lp6cnryoiIiKSEFOuKjL5VNGMGTOwfft2k4uKjY2tcV4Ww6DcgQMH1rnnRC6XQy6Xm1wLERERSZPJwSU9PR0pKSkm7yg/P7/aZWVlZdi8eTMADsolIiKi6lnEqaI9e/YgMDAQLVu2xI0bN+Do6Fiv7XACOiIiIumR3AR0htNEwcHB9Q4tRERE1PSJHlzy8/OxZcsWADxNRERERDUTPbhs2bIF+fn5nOKfiIiIaiV6cOEU/0RERFRXogaXzMxM7N+/HwBPExEREVHtRO3icHd3h16vF7MEIiIikhDRTxURERER1RWDCxEREUkGgwsRERFJBoMLERERSQaDCxEREUkGgwsRERFJBoMLERERSQaDCxEREUkGgwsRERFJBoMLERERSQaDC1E9nDx5Es888wxcXFzQqlUr9OnTB19//bXYZRERNXm8HTORiQ4cOIDAwEDY2dnhxRdfhEKhQHJyMl5++WWkpqZi1qxZYpdIRNRkyQRB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\n", "text/plain": "<Figure size 640x480 with 1 Axes>"}, "metadata": {}, "output_type": "display_data"}]}}, "a00935117f4d45ea8e3c0cf1ba7bb167": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ac3430e4d30d4243be4fcc06c782a170": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3c3ff4e1f80546d1924df6bcdd3fc568", "IPY_MODEL_8fafc55f86d7418e921341d6b1f77b0d"], "layout": "IPY_MODEL_78d876e827c24304a2151e550cc8a030"}}, "b259826ff7f14f13957002fc7f7c4da0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b32f1d0d5b5a45cda2eb208bce75e244": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2231c2db13be40e1a1042bfe699fe32f", "msg_id": "", "outputs": []}}, "b8c767a170f84ed4975f3b58f14681db": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "bd9358fa0b4b4c80b507022e2a12b03e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bed90200a3ec474985170e1faac7bc55": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_8222eafec5ff43e08c7cb0e69671e424", "IPY_MODEL_916d40663c95429a8883619da0a48821"], "layout": "IPY_MODEL_b259826ff7f14f13957002fc7f7c4da0"}}, "ce8d08f031694e20a1e38427c29b3532": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "IntSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f4fd2523204a407ead0213687a140d87", "max": 12, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b8c767a170f84ed4975f3b58f14681db", "value": 6}}, "cf8ad212899142d6a8ba95ec620e8bbd": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e16da577258646f0999dd7c809064cb0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": [], "layout": "IPY_MODEL_b259826ff7f14f13957002fc7f7c4da0"}}, "e42312f987824b5b8c78df9dd4cfdd44": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "ede3ca6ae23444d4b9cb29442bdf7725": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f4fd2523204a407ead0213687a140d87": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '16_dbscan_hierarchical';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Recommender systems" href="17_recommender-systems.html" />
    <link rel="prev" title="Clustering and k-means" href="15_clustering-kmeans.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    ECE 4420/6420 Machine Learning in Engineering
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro.html">Introduction to machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_decision-trees.html">Machine learning concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_ml-fundamentals.html">Machine learning fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_kNNs.html">k-Nearest Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_preprocessing-pipelines.html">Preprocessing and <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="06_column-transformer-text-feats.html"><code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> and text data</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_linear-models.html">Linear models</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_hyperparameter-optimization.html">Hyperparameter optimization and optimization bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_classification-metrics.html">Classification evaluation metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_regression-metrics.html">Regression evaluation metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_ensembles.html">Ensemble learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_multiclass-neuralnetwork.html">Multi-learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_unsupervised-learning-pca.html">Unsupervised learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="15_clustering-kmeans.html">Clustering and k-means</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">DBSCAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_recommender-systems.html">Recommender systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="22_ethics.html">Machine learning fairness</a></li>
<li class="toctree-l1"><a class="reference internal" href="23_feat-importances-xai.html">ML explainability</a></li>
<li class="toctree-l1"><a class="reference internal" href="30_course-review.html">Course review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Things you should know</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="a01_syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="a02_final_project.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="a03_setup.html">Setup</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Attribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="b01_attribution.html">Attributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="b02_LICENSE.html">LICENSE</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/16_dbscan_hierarchical.ipynb" download="16_dbscan_hierarchical.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>DBSCAN</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-name-lo-a">Learning outcomes <a name="lo"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-is-not-sufficient">K-Means is not sufficient</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-recap">K-Means recap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-limitations">K-Means limitations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-limitations-shape-of-k-means-clusters">K-Means limitations: Shape of K-Means clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-1">K-Means: Failure case 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-2">K-Means: Failure case 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-3">K-Means: Failure case 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-useful-clustering-algorithm-dbscan">Another useful clustering algorithm: DBSCAN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan-algorithm">DBSCAN algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-main-hyperparameters">Two main hyperparameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-the-eps-hyperparameter">Effect of the <code class="docutils literal notranslate"><span class="pre">eps</span></code> hyperparameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-the-min-samples-hyperparameter">Effect of the <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> hyperparameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-vs-dbscan">K-Means vs. DBSCAN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-details-on-dbscan">More details on DBSCAN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-hyperparameters-eps-and-min-samples">Illustration of hyperparameters <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-dbscan-clusters">Evaluating DBSCAN clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations">Observations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-pros-and-cons">Summary: Pros and cons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan-failure-cases">DBSCAN: failure cases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">DBSCAN: failure cases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering">Hierarchical clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-idea">Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-hierarchical-clustering">Visualizing hierarchical clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering-input-and-output">Hierarchical clustering input and output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dendrogram">Dendrogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-plot-a-dendrogram">How to plot a dendrogram?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-do-we-mean-by-the-distance-between-clusters">What do we mean by the distance between clusters?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-linkage"><code class="docutils literal notranslate"><span class="pre">single</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-dendrogram-with-single-linkage">Creating a dendrogram with <code class="docutils literal notranslate"><span class="pre">single</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-linkage"><code class="docutils literal notranslate"><span class="pre">average</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-linkage"><code class="docutils literal notranslate"><span class="pre">complete</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ward-linkage"><code class="docutils literal notranslate"><span class="pre">ward</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering-on-un-subvotes-dataset">Hierarchical clustering on UN Subvotes dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-truncation">(Optional) Truncation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flat-cluster">Flat cluster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-for-you">Questions for you</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-clustering-on-face-images">Applying clustering on face images</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-images-from-the-dataset">Example images from the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-images">Representation of images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-faces-with-k-means">Clustering faces with K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-faces-with-dbscan">Clustering faces with DBSCAN</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-eps">Tuning <code class="docutils literal notranslate"><span class="pre">eps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#noise-images-identified-by-dbscan">Noise images identified by DBSCAN</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-clustering-faces-with-hierarchical-clustering">(Optional) Clustering faces with hierarchical clustering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-summary-and-reflection">Final comments, summary, and reflection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-message">Take-home message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-few-comments-on-clustering-evaluation">A few comments on clustering evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-reading-materials">Recommendation reading materials</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dbscan">
<h1>DBSCAN<a class="headerlink" href="#dbscan" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Update: 2023</p></li>
<li><p>Duration: 75 minutes</p></li>
</ul>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">cmle</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_people</span><span class="p">,</span> <span class="n">make_blobs</span><span class="p">,</span> <span class="n">make_moons</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>
<span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">SilhouetteVisualizer</span>


<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="c1"># plt.style.use(&quot;seaborn&quot;)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="learning-outcomes-a-name-lo-a">
<h2>Learning outcomes <a name="lo"></a><a class="headerlink" href="#learning-outcomes-a-name-lo-a" title="Permalink to this heading">#</a></h2>
<p>From this lecture, students are expected to be able to:</p>
<ul class="simple">
<li><p>Identify limitations of K-Means.</p></li>
<li><p>Explain how DBSCAN works at a high level.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> to apply DBSCAN.</p></li>
<li><p>Explain the effect of epsilon and minimum samples hyperparameters in DBSCAN.</p></li>
<li><p>Identify DBSCAN limitations.</p></li>
</ul>
</section>
<section id="k-means-is-not-sufficient">
<h2>K-Means is not sufficient<a class="headerlink" href="#k-means-is-not-sufficient" title="Permalink to this heading">#</a></h2>
<section id="k-means-recap">
<h3>K-Means recap<a class="headerlink" href="#k-means-recap" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We discussed the K-Means clustering in the previous lecture.</p></li>
<li><p>Each cluster is represented by a center.</p></li>
<li><p>Given a new point, you can assign it to a cluster by computing the distances to all cluster centers and picking the cluster with the smallest distance.</p></li>
<li><p>It’s a popular algorithm because</p>
<ul>
<li><p>It’s easy to understand and implement.</p></li>
<li><p>Runs relatively quickly and scales well to large datasets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> has a more scalable variant called <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MiniBatchKMeans.html"><code class="docutils literal notranslate"><span class="pre">MiniBatchKMeans</span></code></a> which can handle very large datasets.</p></li>
</ul>
</li>
</ul>
</section>
<section id="k-means-limitations">
<h3>K-Means limitations<a class="headerlink" href="#k-means-limitations" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Relies on random initialization so the outcome may change depending upon this initialization.</p></li>
<li><p>K-Means clustering requires specifying the number of clusters in advance.</p></li>
<li><p>Very often you do not know the centers in advance. The elbow method or the silhouette method to find the optimal number of clusters is not always easy to interpret.</p></li>
<li><p>Each point has to have a cluster assignment.</p></li>
</ul>
</section>
<section id="k-means-limitations-shape-of-k-means-clusters">
<h3>K-Means limitations: Shape of K-Means clusters<a class="headerlink" href="#k-means-limitations-shape-of-k-means-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>K-Means partitions the space based on the closest mean.</p></li>
<li><p>Each cluster is defined solely by its center so it can only capture relatively simple shapes.</p></li>
<li><p>So the boundaries between clusters are linear; It fails to identify clusters with complex shapes.</p></li>
</ul>
<!-- ![kmeans_boundaries.png](img/kmeans_boundaries.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/kmeans_boundaries.png" alt="kmeans_boundaries.png" width="40%"></center>
<p><a class="reference external" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_digits.html">Source</a></p>
</section>
<section id="k-means-failure-case-1">
<h3>K-Means: Failure case 1<a class="headerlink" href="#k-means-failure-case-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>K-Means performs poorly if the clusters have more complex shapes (e.g., two moons data below).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_k_means</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7ea1298dbb598506c0ab16a1fa31178fa281c6edf655af6d28d95e57df2c3980.png" src="_images/7ea1298dbb598506c0ab16a1fa31178fa281c6edf655af6d28d95e57df2c3980.png" />
</div>
</div>
</section>
<section id="k-means-failure-case-2">
<h3>K-Means: Failure case 2<a class="headerlink" href="#k-means-failure-case-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>It assumes that all directions are equally important for each cluster and fails to identify non-spherical clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate some random cluster data</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">170</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">74</span><span class="p">)</span>
<span class="n">transformation</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">transformation</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_k_means</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/06bdae850370bbf9f3fff980df0353d68c31b0b25f9fdcd8dbabbbfda218b963.png" src="_images/06bdae850370bbf9f3fff980df0353d68c31b0b25f9fdcd8dbabbbfda218b963.png" />
</div>
</div>
</section>
<section id="k-means-failure-case-3">
<h3>K-Means: Failure case 3<a class="headerlink" href="#k-means-failure-case-3" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Again, K-Means is unable to capture complex cluster shapes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_circles</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_k_means</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/73fc5932dedaba94c5046023df19a4833e8ffe6b92bdb7a065a48c909349fe86.png" src="_images/73fc5932dedaba94c5046023df19a4833e8ffe6b92bdb7a065a48c909349fe86.png" />
</div>
</div>
<ul class="simple">
<li><p>Can we do better than this?</p></li>
<li><p>Another clustering algorithm called <strong>DBSCAN</strong> is able to tackle some of these cases.</p></li>
</ul>
</section>
</section>
<section id="another-useful-clustering-algorithm-dbscan">
<h2>Another useful clustering algorithm: DBSCAN<a class="headerlink" href="#another-useful-clustering-algorithm-dbscan" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>D</strong>ensity-<strong>B</strong>ased <strong>S</strong>patial <strong>C</strong>lustering of <strong>A</strong>pplications with <strong>N</strong>oise</p></li>
<li><p>Intuitively, it’s based on the idea that clusters form dense regions in the data and so it works by identifying “crowded” regions in the feature space.</p></li>
<li><p>It can address some of the limitations of K-Means we saw above.</p>
<ul>
<li><p>It does not require the user to specify the number of clusters in advance.</p></li>
<li><p>It can identify points that are not part of any clusters.</p></li>
<li><p>It can capture clusters of complex shapes.</p></li>
</ul>
</li>
</ul>
<p>Let’s try <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s DBSCAN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">dbscan</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_dbscan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dbscan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/84e0cd6861684ee77c5f5ddb95451a9b6855d60a4cc9476e0c7ad4751b09a2f9.png" src="_images/84e0cd6861684ee77c5f5ddb95451a9b6855d60a4cc9476e0c7ad4751b09a2f9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbscan</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  0,  0,  1,  1,  1,  0,  1,  1,  0,  0,  1,  1,  0,  1,  1,  0,
        1,  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,
        1,  1,  1,  1,  1,  0,  0,  1,  0,  0,  1,  1,  0,  0,  1,  0,  1,
        1,  0,  1,  1,  0,  1,  0,  1,  0,  1,  0,  0,  0,  0,  1,  0,  1,
        0,  1,  0,  1,  1,  0,  1,  1,  0,  1, -1,  1,  0,  0,  0,  1,  1,
        0,  1,  0,  1,  0,  0,  1,  1,  0,  0,  1,  1,  0,  0,  1,  0,  0,
        1,  1,  1,  1,  0,  0,  1,  1,  1,  0,  1,  1,  0,  1,  0,  0,  1,
        0,  0,  1,  1,  1,  0,  0,  1,  1,  0,  0,  1,  0,  0,  1,  0,  1,
        0,  1,  0,  1,  1,  1,  1,  0,  0,  0,  0,  1,  0,  0,  1,  1,  0,
        0,  0,  0,  1,  1,  0,  0,  1,  1,  1,  1,  0,  0,  1,  0,  1,  0,
        0,  0,  0,  0,  1,  1,  1,  0,  1,  1,  0,  0,  1,  1,  1,  1,  0,
        1,  0,  0,  1,  1,  0,  1,  0,  1,  0, -1,  1,  1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DBSCAN doesn&#39;t have `predict`.</span>
<span class="c1"># Why?</span>

<span class="c1"># dbscan.predict(X[10])</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>DBSCAN is able to capture the half-moons-shape</p></li>
<li><p>We don’t have to specify the number of clusters.</p>
<ul>
<li><p>That said, it has two other non-trivial hyperparameters to tune.</p></li>
</ul>
</li>
<li><p>There are two examples that have not been assigned any label (noise examples).</p></li>
</ul>
<p>One more example of DBSCAN clusters capturing complex cluster shapes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_circles</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">dbscan</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_dbscan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dbscan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8617a9266e45a99dbb2090eea31aee6d3e4c9496eb272f558768a5b1dc7a7f3b.png" src="_images/8617a9266e45a99dbb2090eea31aee6d3e4c9496eb272f558768a5b1dc7a7f3b.png" />
</div>
</div>
<section id="how-does-it-work">
<h3>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Iterative algorithm.</p></li>
<li><p>Based on the idea that clusters form dense regions in the data.</p></li>
</ul>
<!-- ![dbscan_search.gif](img/dbscan_search.gif) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/dbscan_search.gif" alt="dbscan_search.gif" width="60%"></center>
<p><a class="reference external" href="https://dashee87.github.io/data%20science/general/Clustering-with-Scikit-with-GIFs/">Source</a></p>
</section>
</section>
<section id="dbscan-algorithm">
<h2>DBSCAN algorithm<a class="headerlink" href="#dbscan-algorithm" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;RDZUdRSDOok&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">560</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="1000"
            height="560"
            src="https://www.youtube.com/embed/RDZUdRSDOok?start=180&end=480"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<section id="two-main-hyperparameters">
<h3>Two main hyperparameters<a class="headerlink" href="#two-main-hyperparameters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code>: determines what it means for points to be “close”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_samples</span></code>: determines the number of <strong>neighboring points</strong> we require to consider in order for a point to be part of a cluster</p></li>
</ul>
</section>
<section id="effect-of-the-eps-hyperparameter">
<h3>Effect of the <code class="docutils literal notranslate"><span class="pre">eps</span></code> hyperparameter<a class="headerlink" href="#effect-of-the-eps-hyperparameter" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">interactive</span><span class="p">(</span><span class="k">lambda</span> <span class="n">eps</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span> <span class="n">cmle</span><span class="o">.</span><span class="n">plot_dbscan_with_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">eps</span><span class="p">),</span> <span class="n">eps</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7cf68b0b45eb496eb78d78189de32027", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">euclidean_distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="effect-of-the-min-samples-hyperparameter">
<h3>Effect of the <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> hyperparameter<a class="headerlink" href="#effect-of-the-min-samples-hyperparameter" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span> <span class="n">cmle</span><span class="o">.</span><span class="n">plot_dbscan_with_labels</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">),</span>
    <span class="n">min_samples</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "46ec9a7b99db48a28d81d641e05802a6", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="k-means-vs-dbscan">
<h3>K-Means vs. DBSCAN<a class="headerlink" href="#k-means-vs-dbscan" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In DBSCAN, you do not have to specify the number of clusters!</p>
<ul>
<li><p>Instead, you have to tune <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code>.</p></li>
</ul>
</li>
<li><p>Unlike K-Means, DBSCAN doesn’t have to assign all points to clusters.</p>
<ul>
<li><p>The label is -1 if a point is unassigned.</p></li>
</ul>
</li>
<li><p>Unlike K-Means, there is no <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<ul>
<li><p>DBSCAN only really clusters the points you have, not “new” or “test” points.</p></li>
</ul>
</li>
</ul>
</section>
<section id="more-details-on-dbscan">
<h3>More details on DBSCAN<a class="headerlink" href="#more-details-on-dbscan" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>You’ll find more details in the lecture notebook.</p></li>
</ul>
<p>There are three kinds of points.</p>
<ul class="simple">
<li><p><strong>Core points</strong> are the points that have at least <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> points in the neighborhood.</p></li>
<li><p><strong>Border points</strong> are the points with fewer than <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> points in the neighborhood, but are connected to a core point.</p></li>
<li><p><strong>Noise points</strong> are the points that do not belong to any cluster. In other words, the points that have less than <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> point within distance <code class="docutils literal notranslate"><span class="pre">eps</span></code> of the starting point are noise points.</p></li>
</ul>
<ul class="simple">
<li><p>Default values for hyperparameters don’t work well on toy datasets.</p></li>
<li><p>All points have been marked as noise with the default values for <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code></p></li>
<li><p>Let’s examine the effect of changing these hyperparameters.</p>
<ul>
<li><p>noise points: shown in white</p></li>
<li><p>core points: bigger</p></li>
<li><p>border points: smaller</p></li>
</ul>
</li>
</ul>
</section>
<section id="illustration-of-hyperparameters-eps-and-min-samples">
<h3>Illustration of hyperparameters <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code><a class="headerlink" href="#illustration-of-hyperparameters-eps-and-min-samples" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mglearn</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_dbscan</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min_samples: 2 eps: 1.000000  cluster: [-1  0  0 -1  0 -1  1  1  0  1 -1 -1]
min_samples: 2 eps: 1.500000  cluster: [0 1 1 1 1 0 2 2 1 2 2 0]
min_samples: 2 eps: 2.000000  cluster: [0 1 1 1 1 0 0 0 1 0 0 0]
min_samples: 2 eps: 3.000000  cluster: [0 0 0 0 0 0 0 0 0 0 0 0]
min_samples: 3 eps: 1.000000  cluster: [-1  0  0 -1  0 -1  1  1  0  1 -1 -1]
min_samples: 3 eps: 1.500000  cluster: [0 1 1 1 1 0 2 2 1 2 2 0]
min_samples: 3 eps: 2.000000  cluster: [0 1 1 1 1 0 0 0 1 0 0 0]
min_samples: 3 eps: 3.000000  cluster: [0 0 0 0 0 0 0 0 0 0 0 0]
min_samples: 5 eps: 1.000000  cluster: [-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1]
min_samples: 5 eps: 1.500000  cluster: [-1  0  0  0  0 -1 -1 -1  0 -1 -1 -1]
min_samples: 5 eps: 2.000000  cluster: [-1  0  0  0  0 -1 -1 -1  0 -1 -1 -1]
min_samples: 5 eps: 3.000000  cluster: [0 0 0 0 0 0 0 0 0 0 0 0]
</pre></div>
</div>
<img alt="_images/0fba570d31f78088a3170f5a9799d62433eec3014f02b6f45653955ec4ac9f17.png" src="_images/0fba570d31f78088a3170f5a9799d62433eec3014f02b6f45653955ec4ac9f17.png" />
</div>
</div>
</section>
<section id="evaluating-dbscan-clusters">
<h3>Evaluating DBSCAN clusters<a class="headerlink" href="#evaluating-dbscan-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We cannot use the elbow method to examine the goodness of clusters created with DBSCAN.</p></li>
<li><p>But we can use the silhouette method because it’s not dependent on the idea of cluster centers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">dbscan</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_dbscan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dbscan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79fe9f72f8e838edfbdcb7654de0136cb2e3cac59d396a3790d5c493af324869.png" src="_images/79fe9f72f8e838edfbdcb7654de0136cb2e3cac59d396a3790d5c493af324869.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Yellowbrick is designed to work with K-Means and not with DBSCAN.</span>
<span class="c1"># So it needs the number of clusters stored in n_clusters</span>
<span class="c1"># It also needs `predict` method to be implemented.</span>
<span class="c1"># So I&#39;m implementing it here so that we can use Yellowbrick to show Silhouette plots.</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dbscan</span><span class="o">.</span><span class="n">labels_</span><span class="p">))</span>
<span class="n">dbscan</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span>
<span class="n">dbscan</span><span class="o">.</span><span class="n">predict</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">SilhouetteVisualizer</span>

<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">dbscan</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/854d71321d8759dac59b5ef2063c95a4bfebb407d1d10ea10b221ef4aee43539.png" src="_images/854d71321d8759dac59b5ef2063c95a4bfebb407d1d10ea10b221ef4aee43539.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of DBSCAN Clustering for 300 Samples in 4 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="observations">
<h3>Observations<a class="headerlink" href="#observations" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Increasing <code class="docutils literal notranslate"><span class="pre">eps</span></code> (<span class="math notranslate nohighlight">\(\uparrow\)</span>) (left to right in the plot above) means more points will be included in a cluster.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code> = 1.0 either creates more clusters or more noise points, whereas <code class="docutils literal notranslate"><span class="pre">eps=3.0</span></code> puts all points in one cluster with no noise points.</p></li>
</ul>
</li>
<li><p>Increasing <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> (<span class="math notranslate nohighlight">\(\uparrow\)</span>) (top to bottom in the plot above) means points in less dense regions will either be labeled as their own cluster or noise.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">min_samples=2</span></code>, for instance, has none or only a few noise points whereas <code class="docutils literal notranslate"><span class="pre">min_samples=5</span></code> has several noise points.</p></li>
</ul>
</li>
<li><p>Here <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> = 2.0 or 3.0 and <code class="docutils literal notranslate"><span class="pre">eps</span></code> = 1.5 is giving us the best results.</p></li>
<li><p>In general, it’s not trivial to tune these hyperparameters.</p></li>
</ul>
</section>
<section id="summary-pros-and-cons">
<h3>Summary: Pros and cons<a class="headerlink" href="#summary-pros-and-cons" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Pros</p>
<ul>
<li><p>Can learn arbitrary cluster shapes</p></li>
<li><p>Can detect outliers</p></li>
</ul>
</li>
<li><p>Cons</p>
<ul>
<li><p>Cannot <code class="docutils literal notranslate"><span class="pre">predict</span></code> on new examples.</p></li>
<li><p>Needs tuning of two non-obvious hyperparameters</p></li>
</ul>
</li>
</ul>
<p>There is an improved version of DBSCAN called <a class="reference external" href="https://github.com/scikit-learn-contrib/hdbscan"><code class="docutils literal notranslate"><span class="pre">HDBSCAN</span></code> (hierarchical DBSCAN)</a>.</p>
</section>
<section id="dbscan-failure-cases">
<h3>DBSCAN: failure cases<a class="headerlink" href="#dbscan-failure-cases" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>DBSCAN is able to capture complex clusters. But this doesn’t mean that <code class="docutils literal notranslate"><span class="pre">DBSCAN</span></code> always works better. It has its own problems!</p></li>
<li><p>DBSCAN doesn’t do well when we have clusters with different densities.</p>
<ul>
<li><p>You can play with the hyperparameters but it’s not likely to help much.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id1">
<h3>DBSCAN: failure cases<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s consider this dataset with three clusters of varying densities.</p></li>
<li><p>K-Means performs better compared to DBSCAN. But it has the benefit of knowing the value of <span class="math notranslate nohighlight">\(K\)</span> in advance.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_varied</span><span class="p">,</span> <span class="n">y_varied</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="p">[</span>
                                <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_k_means_dbscan_comparison</span><span class="p">(</span><span class="n">X_varied</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a1ca1e1c7b657281d2e898504d43aa91cb0c025c5cd9e48a9cd0901e7b99cb98.png" src="_images/a1ca1e1c7b657281d2e898504d43aa91cb0c025c5cd9e48a9cd0901e7b99cb98.png" />
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering">
<h2>Hierarchical clustering<a class="headerlink" href="#hierarchical-clustering" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">fcluster</span><span class="p">,</span> <span class="n">linkage</span>
</pre></div>
</div>
</div>
</div>
<section id="motivation">
<h3>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Deciding how many clusters we want is a hard problem.</p></li>
<li><p>Often, it’s useful to get a complete picture of the similarity between points in our data before picking the number of clusters.</p></li>
<li><p>Hierarchical clustering is helpful in these scenarios.</p></li>
</ul>
</section>
<section id="main-idea">
<h3>Main idea<a class="headerlink" href="#main-idea" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Start with each point in its own cluster.</p></li>
<li><p>Greedily merge most similar <em>clusters</em>.</p></li>
<li><p>Repeat Step 2 until you obtain only one cluster (<span class="math notranslate nohighlight">\(n-1\)</span> times).</p></li>
</ol>
</section>
<section id="visualizing-hierarchical-clustering">
<h3>Visualizing hierarchical clustering<a class="headerlink" href="#visualizing-hierarchical-clustering" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Hierarchical clustering can be visualized using a tool called <strong>a dendrogram</strong>.</p></li>
<li><p>Unfortunately, <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> cannot do it so we will use the package <code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy</span></code> for hierarchical clustering.</p></li>
</ul>
</section>
<section id="hierarchical-clustering-input-and-output">
<h3>Hierarchical clustering input and output<a class="headerlink" href="#hierarchical-clustering-input-and-output" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">ward</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">linkage_array</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_dendrogram</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">linkage_array</span><span class="p">,</span> <span class="n">label_n_clusters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/699538b60353b39a8774b8604433c876e8fc4359dda4e20d6580b3f945ff8bff.png" src="_images/699538b60353b39a8774b8604433c876e8fc4359dda4e20d6580b3f945ff8bff.png" />
</div>
</div>
<ul class="simple">
<li><p>Every point goes through the journey of being on its own (its own cluster) and getting merged with some other bigger clusters.</p></li>
<li><p>The intermediate steps in the process provide us with clustering with different numbers of clusters.</p></li>
</ul>
</section>
<section id="dendrogram">
<h3>Dendrogram<a class="headerlink" href="#dendrogram" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>A dendrogram is a tree-like plot.</p></li>
<li><p>On the x-axis, we have data points.</p></li>
<li><p>On the y-axis, we have distances between clusters.</p></li>
<li><p>We start with data points as leaves of the tree.</p></li>
<li><p>A new parent node is created for every two clusters that are joined.</p></li>
<li><p>The length of each branch shows how far the merged clusters go.</p>
<ul>
<li><p>In the dendrogram above going from three clusters to two clusters means merging far apart points because the branches between three clusters to two clusters are long.</p></li>
</ul>
</li>
</ul>
</section>
<section id="how-to-plot-a-dendrogram">
<h3>How to plot a dendrogram?<a class="headerlink" href="#how-to-plot-a-dendrogram" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_array</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cluster distance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cluster distance&#39;)
</pre></div>
</div>
<img alt="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" src="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" />
</div>
</div>
</section>
<section id="what-do-we-mean-by-the-distance-between-clusters">
<h3>What do we mean by the distance between clusters?<a class="headerlink" href="#what-do-we-mean-by-the-distance-between-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We know how to measure distance between points (e.g., using Euclidean distance).</p></li>
<li><p>How do we measure distances between clusters?</p></li>
<li><p>The <strong>linkage criteria</strong> determines how to find similarity between clusters:</p></li>
<li><p>Some example linkage criteria are:</p>
<ul>
<li><p>Single linkage (minimum distance)</p></li>
<li><p>Average linkage (average distance)</p></li>
<li><p>Complete (or maximum) linkage (maximum distance)</p></li>
<li><p>Ward linkage</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_X_dendrogram</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">linkage_array</span><span class="p">,</span> <span class="n">label_n_clusters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/699538b60353b39a8774b8604433c876e8fc4359dda4e20d6580b3f945ff8bff.png" src="_images/699538b60353b39a8774b8604433c876e8fc4359dda4e20d6580b3f945ff8bff.png" />
</div>
</div>
</section>
<section id="single-linkage">
<h3><code class="docutils literal notranslate"><span class="pre">single</span></code> linkage<a class="headerlink" href="#single-linkage" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Merges two clusters that have the smallest minimum distance between all their points.</p></li>
<li><p>Let’s use <code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy</span></code>’s <code class="docutils literal notranslate"><span class="pre">single</span></code> to get linkage information.</p></li>
<li><p>This method gives us matrix <code class="docutils literal notranslate"><span class="pre">Z</span></code> with the merging information.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">average</span><span class="p">,</span> <span class="n">complete</span><span class="p">,</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">fcluster</span><span class="p">,</span> <span class="n">single</span><span class="p">,</span> <span class="n">ward</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">single</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">,</span> <span class="s2">&quot;distance(c1, c2)&quot;</span><span class="p">,</span> <span class="s2">&quot;# observations&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c1</th>
      <th>c2</th>
      <th>distance(c1, c2)</th>
      <th># observations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.332095</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>9.0</td>
      <td>0.645802</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>11.0</td>
      <td>0.911272</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>12.0</td>
      <td>0.989059</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>13.0</td>
      <td>1.072565</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The linkage returns a matrix <code class="docutils literal notranslate"><span class="pre">Z</span></code> of shape <code class="docutils literal notranslate"><span class="pre">n-1</span></code> (number of iterations) by 4:</p></li>
<li><p>The rows represent iterations.</p></li>
<li><p>First and second columns (c1 and c2 above): indexes of the clusters being merged.</p></li>
<li><p>Third column (distance(c1, c2)): the distance between the clusters being merged.</p></li>
<li><p>Fourth column (# observations): the number of examples in the newly formed cluster.</p></li>
</ul>
</section>
<section id="creating-a-dendrogram-with-single-linkage">
<h3>Creating a dendrogram with <code class="docutils literal notranslate"><span class="pre">single</span></code> linkage<a class="headerlink" href="#creating-a-dendrogram-with-single-linkage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="c1"># Z is our single linkage matrix</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dendrogram (Single linkage)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Dendrogram (Single linkage)&#39;)
</pre></div>
</div>
<img alt="_images/be05389e0bbd68d8eb6fb1612ec45181a5af176db0b03ca1bf59f760c9846ea1.png" src="_images/be05389e0bbd68d8eb6fb1612ec45181a5af176db0b03ca1bf59f760c9846ea1.png" />
</div>
</div>
</section>
<section id="average-linkage">
<h3><code class="docutils literal notranslate"><span class="pre">average</span></code> linkage<a class="headerlink" href="#average-linkage" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Merges two clusters that have the smallest average distance between all their points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy</span></code>’s <code class="docutils literal notranslate"><span class="pre">average</span></code> method gives us matrix <code class="docutils literal notranslate"><span class="pre">Z</span></code> with the merging information using average linkage.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="c1"># Dendrogram with average linkage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dendrogram (Average linkage)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Dendrogram (Average linkage)&#39;)
</pre></div>
</div>
<img alt="_images/d28c17601b4893c28425543c964b1ed54154774ff0d366f9c271a57c632e1324.png" src="_images/d28c17601b4893c28425543c964b1ed54154774ff0d366f9c271a57c632e1324.png" />
</div>
</div>
</section>
<section id="complete-linkage">
<h3><code class="docutils literal notranslate"><span class="pre">complete</span></code> linkage<a class="headerlink" href="#complete-linkage" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Merges two clusters that have the smallest maximum distance between their points.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">complete</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="c1"># Dendrogram with complete linkage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dendrogram (Complete linkage)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Dendrogram (Complete linkage)&#39;)
</pre></div>
</div>
<img alt="_images/9b7ea57e693f7f0c12445bc1aeb433d84f72cb15e9ad5348e584b633ab8bda60.png" src="_images/9b7ea57e693f7f0c12445bc1aeb433d84f72cb15e9ad5348e584b633ab8bda60.png" />
</div>
</div>
</section>
<section id="ward-linkage">
<h3><code class="docutils literal notranslate"><span class="pre">ward</span></code> linkage<a class="headerlink" href="#ward-linkage" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Picks two clusters to merge such that the variance within all clusters increases the least.</p></li>
<li><p>Often leads to equally sized clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="c1"># Dendrogram with ward linkage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dendrogram (Ward linkage)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Dendrogram (Ward linkage)&#39;)
</pre></div>
</div>
<img alt="_images/61d4be5b73fc3c78efa79a889bbbd8c24d643ddc35f434e792b688f767878547.png" src="_images/61d4be5b73fc3c78efa79a889bbbd8c24d643ddc35f434e792b688f767878547.png" />
</div>
</div>
<p><br><br></p>
</section>
<section id="hierarchical-clustering-on-un-subvotes-dataset">
<h3>Hierarchical clustering on UN Subvotes dataset<a class="headerlink" href="#hierarchical-clustering-on-un-subvotes-dataset" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s use a dataset of votes on UN resolutions:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;data/subvotes.csv&quot;</span><span class="p">)</span>
<span class="n">votes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/subvotes.csv&quot;</span><span class="p">)</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">votes_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;rcid&quot;</span><span class="p">)</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">votes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">votes</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">votes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">votes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(17, 368)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="21" halign="left">vote</th>
    </tr>
    <tr>
      <th>rcid</th>
      <th>2491</th>
      <th>2492</th>
      <th>2497</th>
      <th>2504</th>
      <th>2510</th>
      <th>2526</th>
      <th>2563</th>
      <th>2610</th>
      <th>2641</th>
      <th>2645</th>
      <th>...</th>
      <th>5321</th>
      <th>5333</th>
      <th>5337</th>
      <th>5358</th>
      <th>5363</th>
      <th>5364</th>
      <th>5365</th>
      <th>5367</th>
      <th>5383</th>
      <th>5385</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 368 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>We have 17 countries and 368 votes.</p></li>
<li><p>Let’s cluster countries based on how they vote.</p></li>
</ul>
<ul class="simple">
<li><p>We’ll use <a class="reference external" href="https://en.wikipedia.org/wiki/Hamming_distance">hamming distance</a> here because we are interested in knowing whether the countries agreed or disagreed on resolutions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_dendrogram</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
    <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">votes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dendrogram</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9676e80a1ca36109d4aad3635230311669fc3c1488009870dc2e7b4596dda69f.png" src="_images/9676e80a1ca36109d4aad3635230311669fc3c1488009870dc2e7b4596dda69f.png" />
</div>
</div>
</section>
<section id="optional-truncation">
<h3>(Optional) Truncation<a class="headerlink" href="#optional-truncation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>If you want to truncate the tree in the dendrogram (especially when you have a big <span class="math notranslate nohighlight">\(n\)</span>) you can use the <code class="docutils literal notranslate"><span class="pre">truncate_mode</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s2">&quot;lastp&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">votes</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1"># p is the number of leaves when truncate mode is &quot;lastp&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;icoord&#39;: [[15.0, 15.0, 25.0, 25.0],
  [45.0, 45.0, 55.0, 55.0],
  [35.0, 35.0, 50.0, 50.0],
  [20.0, 20.0, 42.5, 42.5],
  [5.0, 5.0, 31.25, 31.25]],
 &#39;dcoord&#39;: [[0.0, 0.23967391304347826, 0.23967391304347826, 0.0],
  [0.0, 0.2377717391304348, 0.2377717391304348, 0.0],
  [0.0, 0.3269927536231884, 0.3269927536231884, 0.2377717391304348],
  [0.23967391304347826,
   0.44738142292490124,
   0.44738142292490124,
   0.3269927536231884],
  [0.0, 0.5237771739130435, 0.5237771739130435, 0.44738142292490124]],
 &#39;ivl&#39;: [&#39;USA&#39;, &#39;Australia&#39;, &#39;(10)&#39;, &#39;(2)&#39;, &#39;Brazil&#39;, &#39;(2)&#39;],
 &#39;leaves&#39;: [16, 0, 26, 24, 2, 27],
 &#39;color_list&#39;: [&#39;C1&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C0&#39;, &#39;C0&#39;],
 &#39;leaves_color_list&#39;: [&#39;C0&#39;, &#39;C1&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C2&#39;]}
</pre></div>
</div>
<img alt="_images/1dbf2b340c67b1f2ab7b19f220bb9536418ddea25631b8af9b13ce9fbebc65fd.png" src="_images/1dbf2b340c67b1f2ab7b19f220bb9536418ddea25631b8af9b13ce9fbebc65fd.png" />
</div>
</div>
<ul class="simple">
<li><p>Alternatively, you can truncate the tree down to <span class="math notranslate nohighlight">\(x\)</span> levels from the single cluster:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">votes</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1"># p is the max depth of the tree when truncate_mode is &quot;level&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;icoord&#39;: [[45.0, 45.0, 55.0, 55.0],
  [65.0, 65.0, 75.0, 75.0],
  [50.0, 50.0, 70.0, 70.0],
  [35.0, 35.0, 60.0, 60.0],
  [25.0, 25.0, 47.5, 47.5],
  [15.0, 15.0, 36.25, 36.25],
  [85.0, 85.0, 95.0, 95.0],
  [115.0, 115.0, 125.0, 125.0],
  [105.0, 105.0, 120.0, 120.0],
  [90.0, 90.0, 112.5, 112.5],
  [25.625, 25.625, 101.25, 101.25],
  [5.0, 5.0, 63.4375, 63.4375]],
 &#39;dcoord&#39;: [[0.0, 0.07110507246376811, 0.07110507246376811, 0.0],
  [0.0, 0.09239130434782608, 0.09239130434782608, 0.0],
  [0.07110507246376811,
   0.09963768115942029,
   0.09963768115942029,
   0.09239130434782608],
  [0.0, 0.1297554347826087, 0.1297554347826087, 0.09963768115942029],
  [0.0, 0.1488526570048309, 0.1488526570048309, 0.1297554347826087],
  [0.0, 0.23967391304347826, 0.23967391304347826, 0.1488526570048309],
  [0.0, 0.11956521739130435, 0.11956521739130435, 0.0],
  [0.0, 0.1875, 0.1875, 0.0],
  [0.0, 0.2377717391304348, 0.2377717391304348, 0.1875],
  [0.11956521739130435,
   0.3269927536231884,
   0.3269927536231884,
   0.2377717391304348],
  [0.23967391304347826,
   0.44738142292490124,
   0.44738142292490124,
   0.3269927536231884],
  [0.0, 0.5237771739130435, 0.5237771739130435, 0.44738142292490124]],
 &#39;ivl&#39;: [&#39;USA&#39;,
  &#39;Australia&#39;,
  &#39;UK&#39;,
  &#39;Japan&#39;,
  &#39;(3)&#39;,
  &#39;(2)&#39;,
  &#39;Finland&#39;,
  &#39;(2)&#39;,
  &#39;Malaysia&#39;,
  &#39;Sri Lanka&#39;,
  &#39;Brazil&#39;,
  &#39;Colombia&#39;,
  &#39;Peru&#39;],
 &#39;leaves&#39;: [16, 0, 15, 7, 18, 19, 5, 20, 8, 14, 2, 3, 11],
 &#39;color_list&#39;: [&#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C0&#39;,
  &#39;C0&#39;],
 &#39;leaves_color_list&#39;: [&#39;C0&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C1&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;,
  &#39;C2&#39;]}
</pre></div>
</div>
<img alt="_images/d735ce7d067e83b55eb5f8c5047a43b3e2b8750995d6b3cc3e21dae78ff95576.png" src="_images/d735ce7d067e83b55eb5f8c5047a43b3e2b8750995d6b3cc3e21dae78ff95576.png" />
</div>
</div>
<p>Let’s go back to our toy dataset to understand truncation better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_array</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cluster distance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cluster distance&#39;)
</pre></div>
</div>
<img alt="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" src="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>
<span class="c1"># p is the max depth of the tree</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;icoord&#39;: [[25.0, 25.0, 35.0, 35.0],
  [15.0, 15.0, 30.0, 30.0],
  [45.0, 45.0, 55.0, 55.0],
  [65.0, 65.0, 75.0, 75.0],
  [50.0, 50.0, 70.0, 70.0],
  [22.5, 22.5, 60.0, 60.0],
  [5.0, 5.0, 41.25, 41.25]],
 &#39;dcoord&#39;: [[0.0, 0.1488526570048309, 0.1488526570048309, 0.0],
  [0.0, 0.23967391304347826, 0.23967391304347826, 0.1488526570048309],
  [0.0, 0.11956521739130435, 0.11956521739130435, 0.0],
  [0.0, 0.2377717391304348, 0.2377717391304348, 0.0],
  [0.11956521739130435,
   0.3269927536231884,
   0.3269927536231884,
   0.2377717391304348],
  [0.23967391304347826,
   0.44738142292490124,
   0.44738142292490124,
   0.3269927536231884],
  [0.0, 0.5237771739130435, 0.5237771739130435, 0.44738142292490124]],
 &#39;ivl&#39;: [&#39;16&#39;, &#39;0&#39;, &#39;15&#39;, &#39;(9)&#39;, &#39;8&#39;, &#39;14&#39;, &#39;2&#39;, &#39;(2)&#39;],
 &#39;leaves&#39;: [16, 0, 15, 25, 8, 14, 2, 27],
 &#39;color_list&#39;: [&#39;C1&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C0&#39;, &#39;C0&#39;],
 &#39;leaves_color_list&#39;: [&#39;C0&#39;, &#39;C1&#39;, &#39;C1&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C2&#39;, &#39;C2&#39;]}
</pre></div>
</div>
<img alt="_images/31d48448f2eb51f6897ac7274c8f11696c57effa2de5a883cc8cad9619872c47.png" src="_images/31d48448f2eb51f6897ac7274c8f11696c57effa2de5a883cc8cad9619872c47.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s2">&quot;lastp&quot;</span><span class="p">)</span>
<span class="c1"># p is the number of leaf nodes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;icoord&#39;: [[25.0, 25.0, 35.0, 35.0],
  [15.0, 15.0, 30.0, 30.0],
  [5.0, 5.0, 22.5, 22.5]],
 &#39;dcoord&#39;: [[0.0, 0.3269927536231884, 0.3269927536231884, 0.0],
  [0.0, 0.44738142292490124, 0.44738142292490124, 0.3269927536231884],
  [0.0, 0.5237771739130435, 0.5237771739130435, 0.44738142292490124]],
 &#39;ivl&#39;: [&#39;16&#39;, &#39;(11)&#39;, &#39;(2)&#39;, &#39;(3)&#39;],
 &#39;leaves&#39;: [16, 29, 24, 28],
 &#39;color_list&#39;: [&#39;C1&#39;, &#39;C0&#39;, &#39;C0&#39;],
 &#39;leaves_color_list&#39;: [&#39;C0&#39;, &#39;C0&#39;, &#39;C1&#39;, &#39;C1&#39;]}
</pre></div>
</div>
<img alt="_images/df114c7f6878608107921a19d5dea3a74faa77263726c0d93f2246293564de5e.png" src="_images/df114c7f6878608107921a19d5dea3a74faa77263726c0d93f2246293564de5e.png" />
</div>
</div>
</section>
<section id="flat-cluster">
<h3>Flat cluster<a class="headerlink" href="#flat-cluster" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>To bring the clustering to a “flat” format, we can use <code class="docutils literal notranslate"><span class="pre">fcluster</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">fcluster</span>

<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;maxclust&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cluster_labels</span><span class="p">,</span> <span class="n">votes</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>5</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>4</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Malaysia</th>
      <td>3</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>4</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Sri Lanka</th>
      <td>3</td>
    </tr>
    <tr>
      <th>UK</th>
      <td>1</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To understand this better, let’s try it out on our toy dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_array</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cluster distance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cluster distance&#39;)
</pre></div>
</div>
<img alt="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" src="_images/38f46673e0c4e9cbc209d01c323baa4f44f5e49e849ebc443e11a35670556bed.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">linkage_array</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;maxclust&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cluster_labels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><br><br></p>
</section>
</section>
<section id="questions-for-you">
<h2>Questions for you<a class="headerlink" href="#questions-for-you" title="Permalink to this heading">#</a></h2>
<p><strong>Select all of the following statements which are TRUE.</strong></p>
<ul class="simple">
<li><p>(A) With tiny epsilon (<code class="docutils literal notranslate"><span class="pre">eps</span></code> in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>) and min samples=1 (<code class="docutils literal notranslate"><span class="pre">min_samples=1</span></code> in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>) we are likely to end up with each point in its own cluster.</p></li>
<li><p>(B) With a smaller value of <code class="docutils literal notranslate"><span class="pre">eps</span></code> and a larger number for <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> we are likely to end up with one big cluster.</p></li>
<li><p>(C) K-Means is more susceptible to outliers compared to DBSCAN.</p></li>
<li><p>(D) In DBSCAN to be part of a cluster, each point must have at least <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> neighbors in a given radius (including itself).</p></li>
<li><p>(E) In DBSCAN, it is generally a good idea to run DBSCAN with a large number of different random orderings of training examples.</p></li>
</ul>
<p><br><br><br><br></p>
<p><strong>Select all of the following statements which are TRUE.</strong></p>
<ul class="simple">
<li><p>(A) In hierarchical clustering we do not have to worry about initialization.</p></li>
<li><p>(B) Hierarchical clustering can only be applied to smaller datasets because dendrograms are hard to visualize for large datasets.</p></li>
<li><p>(C) In all the three clustering methods we saw (K-Means, DBSCAN, hierarchical clustering), there is a way to decide the granularity of clustering (i.e., how many clusters to pick).</p></li>
<li><p>(D) To get robust clustering we can naively ensemble cluster labels (e.g., pick the most popular label) produced by different clustering methods.</p></li>
<li><p>(E) If you have a high Silhouette score and very clean and robust clusters, it means that the algorithm has captured the semantic meaning in the data of our interest.
<br><br><br><br></p></li>
</ul>
</section>
<section id="applying-clustering-on-face-images">
<h2>Applying clustering on face images<a class="headerlink" href="#applying-clustering-on-face-images" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>We’ll be working with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <a class="reference external" href="https://scikit-learn.org/0.16/datasets/labeled_faces.html">Labeled Faces in the Wild dataset</a>.</p></li>
<li><p>The dataset has images of celebrities from the early 2000s downloaded from the internet.</p></li>
</ul>
<blockquote>
<div><p>Credit: This example is based on the example from <a class="reference external" href="https://learning.oreilly.com/library/view/introduction-to-machine/9781449369880/ch03.html">here</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_people</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;image.cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gray&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="example-images-from-the-dataset">
<h3>Example images from the dataset<a class="headerlink" href="#example-images-from-the-dataset" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="n">fetch_lfw_people</span><span class="p">(</span><span class="n">min_faces_per_person</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span>
                         <span class="s2">&quot;xticks&quot;</span><span class="p">:</span> <span class="p">(),</span> <span class="s2">&quot;yticks&quot;</span><span class="p">:</span> <span class="p">()})</span>
<span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">people</span><span class="o">.</span><span class="n">images</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dacb288300a2b45e9e69b8e13b37137510d8910293f7276bef8a7346f4245632.png" src="_images/dacb288300a2b45e9e69b8e13b37137510d8910293f7276bef8a7346f4245632.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_shape</span> <span class="o">=</span> <span class="n">people</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;people.images.shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of classes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>people.images.shape: (3023, 87, 65)
Number of classes: 62
</pre></div>
</div>
</div>
</div>
<p>There are 3,023 images stored as arrays of 5655 pixels (87 by 65), of 62 different people:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>  <span class="c1"># count how often each target appears</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>George W Bush</th>
      <td>530</td>
    </tr>
    <tr>
      <th>Colin Powell</th>
      <td>236</td>
    </tr>
    <tr>
      <th>Tony Blair</th>
      <td>144</td>
    </tr>
    <tr>
      <th>Donald Rumsfeld</th>
      <td>121</td>
    </tr>
    <tr>
      <th>Gerhard Schroeder</th>
      <td>109</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>Angelina Jolie</th>
      <td>20</td>
    </tr>
    <tr>
      <th>Jiang Zemin</th>
      <td>20</td>
    </tr>
    <tr>
      <th>Paul Bremer</th>
      <td>20</td>
    </tr>
    <tr>
      <th>Igor Ivanov</th>
      <td>20</td>
    </tr>
    <tr>
      <th>Michael Bloomberg</th>
      <td>20</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 1 columns</p>
</div></div></div>
</div>
<p>Let’s make the data less skewed by taking only 20 images of each person.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
    <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">20</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">X_people</span> <span class="o">=</span> <span class="n">people</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mi">256</span>
<span class="n">y_people</span> <span class="o">=</span> <span class="n">people</span><span class="o">.</span><span class="n">target</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_people</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1240, 5655)
</pre></div>
</div>
</div>
</div>
</section>
<section id="representation-of-images">
<h3>Representation of images<a class="headerlink" href="#representation-of-images" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Representation of input is very important when you cluster examples.</p></li>
<li><p>In this example, we’ll use PCA representation. (We won’t learn about PCA in this course. You can think of it as a method to extract the most important information from the given data.)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_people</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="clustering-faces-with-k-means">
<h3>Clustering faces with K-Means<a class="headerlink" href="#clustering-faces-with-k-means" title="Permalink to this heading">#</a></h3>
<p>We’ll cluster the images with this new representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=10, random_state=10)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=10, random_state=10)</pre></div></div></div></div></div></div></div>
</div>
<p>What are the sizes of the clusters?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels_km</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [ 36 309  65 108  89  39  98 210 168 118]
</pre></div>
</div>
</div>
</div>
<p>Let’s examine cluster centers. Are they going to be real images from the dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_faces_cluster_centers</span><span class="p">(</span><span class="n">km</span><span class="p">,</span> <span class="n">pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b12d380f3cf91be269431766f4383493b359d32fe4a80426217c86e502f6d7d5.png" src="_images/b12d380f3cf91be269431766f4383493b359d32fe4a80426217c86e502f6d7d5.png" />
</div>
</div>
<ul class="simple">
<li><p>The centers found by K-Means are smooth versions of faces which makes sense.</p></li>
<li><p>Intuitively, they seem to capture some interesting characteristics of faces:</p>
<ul>
<li><p>Grumpy faces</p></li>
<li><p>Faces somewhat rotated to the left/right</p></li>
<li><p>Smiley faces</p></li>
</ul>
</li>
</ul>
<p>Let’s examine images for different centers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_cluster_images</span><span class="p">(</span><span class="n">km</span><span class="p">,</span> <span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">target_names</span><span class="p">,</span> <span class="n">X_pca</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pca</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">image_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">87</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xticks&#39;</span><span class="p">:</span> <span class="p">(),</span> <span class="s1">&#39;yticks&#39;</span><span class="p">:</span> <span class="p">()},</span>
                             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hspace&quot;</span><span class="p">:</span> <span class="mf">.3</span><span class="p">})</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">cluster</span><span class="p">]</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="n">cluster</span>

    <span class="k">if</span> <span class="n">pca</span><span class="p">:</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_pca</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dists</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_people</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dists</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cluster center </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cluster</span><span class="p">))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_people</span><span class="p">[</span><span class="n">inds</span><span class="p">],</span> <span class="n">y_people</span><span class="p">[</span><span class="n">inds</span><span class="p">]):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target_names</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                          <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_cluster_images</span><span class="p">(</span>
    <span class="n">km</span><span class="p">,</span> <span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span> <span class="n">pca</span><span class="o">=</span><span class="n">pca</span><span class="p">,</span> <span class="n">X_pca</span><span class="o">=</span><span class="n">X_pca</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c82b134ac46495709142123b8f67e5f7622e3394fcf39560db23d42df96f1884.png" src="_images/c82b134ac46495709142123b8f67e5f7622e3394fcf39560db23d42df96f1884.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_cluster_images</span><span class="p">(</span>
    <span class="n">km</span><span class="p">,</span> <span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span> <span class="n">pca</span><span class="o">=</span><span class="n">pca</span><span class="p">,</span> <span class="n">X_pca</span><span class="o">=</span><span class="n">X_pca</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="mi">8</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f8ccbef46c3a845e497895116c61329f6c1380a626bb4509e6411d0e6223de1.png" src="_images/1f8ccbef46c3a845e497895116c61329f6c1380a626bb4509e6411d0e6223de1.png" />
</div>
</div>
</section>
<section id="clustering-faces-with-dbscan">
<h3>Clustering faces with DBSCAN<a class="headerlink" href="#clustering-faces-with-dbscan" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">()</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique labels: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique labels: [-1]
</pre></div>
</div>
</div>
</div>
<p>With default hyperparameters, we get all points as noise points.</p>
<section id="tuning-eps">
<h4>Tuning <code class="docutils literal notranslate"><span class="pre">eps</span></code><a class="headerlink" href="#tuning-eps" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">y_people</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1240,)
</pre></div>
</div>
</div>
</div>
<p>Let’s examine at distances between images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>

<span class="n">dists</span> <span class="o">=</span> <span class="n">euclidean_distances</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

<span class="n">dist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">dists</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">y_people</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">y_people</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">dist_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>George W Bush</th>
      <th>George W Bush</th>
      <th>Nestor Kirchner</th>
      <th>Jean Chretien</th>
      <th>Bill Clinton</th>
      <th>George W Bush</th>
      <th>Carlos Menem</th>
      <th>Alvaro Uribe</th>
      <th>George W Bush</th>
      <th>Colin Powell</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>George W Bush</th>
      <td>inf</td>
      <td>11.544726</td>
      <td>10.258088</td>
      <td>12.427369</td>
      <td>12.644954</td>
      <td>11.121598</td>
      <td>13.138453</td>
      <td>14.667105</td>
      <td>15.530873</td>
      <td>10.503779</td>
    </tr>
    <tr>
      <th>George W Bush</th>
      <td>11.544726</td>
      <td>inf</td>
      <td>10.303782</td>
      <td>13.642813</td>
      <td>14.271922</td>
      <td>11.599442</td>
      <td>12.474014</td>
      <td>15.075000</td>
      <td>15.033495</td>
      <td>11.432457</td>
    </tr>
    <tr>
      <th>Nestor Kirchner</th>
      <td>10.258088</td>
      <td>10.303782</td>
      <td>inf</td>
      <td>10.842855</td>
      <td>13.600072</td>
      <td>10.531936</td>
      <td>11.576278</td>
      <td>14.146925</td>
      <td>15.191017</td>
      <td>8.954872</td>
    </tr>
    <tr>
      <th>Jean Chretien</th>
      <td>12.427369</td>
      <td>13.642813</td>
      <td>10.842855</td>
      <td>inf</td>
      <td>13.578995</td>
      <td>13.104000</td>
      <td>13.568862</td>
      <td>16.059177</td>
      <td>16.865273</td>
      <td>11.750570</td>
    </tr>
    <tr>
      <th>Bill Clinton</th>
      <td>12.644954</td>
      <td>14.271922</td>
      <td>13.600072</td>
      <td>13.578995</td>
      <td>inf</td>
      <td>14.232129</td>
      <td>15.222552</td>
      <td>16.806553</td>
      <td>16.797373</td>
      <td>14.481402</td>
    </tr>
    <tr>
      <th>George W Bush</th>
      <td>11.121598</td>
      <td>11.599442</td>
      <td>10.531936</td>
      <td>13.104000</td>
      <td>14.232129</td>
      <td>inf</td>
      <td>12.665569</td>
      <td>15.961424</td>
      <td>13.975034</td>
      <td>11.810294</td>
    </tr>
    <tr>
      <th>Carlos Menem</th>
      <td>13.138453</td>
      <td>12.474014</td>
      <td>11.576278</td>
      <td>13.568862</td>
      <td>15.222552</td>
      <td>12.665569</td>
      <td>inf</td>
      <td>16.289387</td>
      <td>15.075185</td>
      <td>10.978153</td>
    </tr>
    <tr>
      <th>Alvaro Uribe</th>
      <td>14.667105</td>
      <td>15.075000</td>
      <td>14.146925</td>
      <td>16.059177</td>
      <td>16.806553</td>
      <td>15.961424</td>
      <td>16.289387</td>
      <td>inf</td>
      <td>17.566317</td>
      <td>14.859702</td>
    </tr>
    <tr>
      <th>George W Bush</th>
      <td>15.530873</td>
      <td>15.033495</td>
      <td>15.191017</td>
      <td>16.865273</td>
      <td>16.797373</td>
      <td>13.975034</td>
      <td>15.075185</td>
      <td>17.566317</td>
      <td>inf</td>
      <td>15.792854</td>
    </tr>
    <tr>
      <th>Colin Powell</th>
      <td>10.503779</td>
      <td>11.432457</td>
      <td>8.954872</td>
      <td>11.750570</td>
      <td>14.481402</td>
      <td>11.810294</td>
      <td>10.978153</td>
      <td>14.859702</td>
      <td>15.792854</td>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Winona Ryder</th>
      <th>Jean Chretien</th>
      <th>Carlos Menem</th>
      <th>Ariel Sharon</th>
      <th>Alvaro Uribe</th>
      <th>Colin Powell</th>
      <th>Recep Tayyip Erdogan</th>
      <th>Gray Davis</th>
      <th>George Robertson</th>
      <th>Silvio Berlusconi</th>
      <th>...</th>
      <th>Igor Ivanov</th>
      <th>Hamid Karzai</th>
      <th>Igor Ivanov</th>
      <th>Jiang Zemin</th>
      <th>Carlos Menem</th>
      <th>Michael Bloomberg</th>
      <th>Paul Bremer</th>
      <th>Jiang Zemin</th>
      <th>Paul Bremer</th>
      <th>Igor Ivanov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>...</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
      <td>1240.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>...</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>10.798941</td>
      <td>9.188456</td>
      <td>10.955708</td>
      <td>10.340692</td>
      <td>10.586761</td>
      <td>7.991092</td>
      <td>10.084940</td>
      <td>12.265063</td>
      <td>8.269715</td>
      <td>8.073891</td>
      <td>...</td>
      <td>9.934309</td>
      <td>16.630966</td>
      <td>7.218455</td>
      <td>9.620401</td>
      <td>8.732934</td>
      <td>8.432673</td>
      <td>10.796836</td>
      <td>9.316420</td>
      <td>11.808144</td>
      <td>9.981050</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>13.646841</td>
      <td>12.039100</td>
      <td>13.315297</td>
      <td>13.102979</td>
      <td>13.116850</td>
      <td>11.132256</td>
      <td>12.571774</td>
      <td>14.653522</td>
      <td>12.655002</td>
      <td>11.025023</td>
      <td>...</td>
      <td>12.594154</td>
      <td>18.882246</td>
      <td>10.212047</td>
      <td>13.110558</td>
      <td>11.774529</td>
      <td>11.506841</td>
      <td>13.497954</td>
      <td>12.350000</td>
      <td>14.300536</td>
      <td>13.190873</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>14.483325</td>
      <td>12.964636</td>
      <td>14.130375</td>
      <td>14.024138</td>
      <td>14.020593</td>
      <td>12.102510</td>
      <td>13.433449</td>
      <td>15.451756</td>
      <td>13.495016</td>
      <td>11.960471</td>
      <td>...</td>
      <td>13.427207</td>
      <td>19.615459</td>
      <td>11.292739</td>
      <td>13.960770</td>
      <td>12.564590</td>
      <td>12.429490</td>
      <td>14.308200</td>
      <td>13.208097</td>
      <td>15.122154</td>
      <td>14.033502</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>15.537401</td>
      <td>14.091517</td>
      <td>15.044791</td>
      <td>15.091705</td>
      <td>15.052523</td>
      <td>13.347604</td>
      <td>14.531166</td>
      <td>16.457000</td>
      <td>14.588343</td>
      <td>13.204581</td>
      <td>...</td>
      <td>14.521263</td>
      <td>20.430758</td>
      <td>12.572391</td>
      <td>15.105683</td>
      <td>13.666411</td>
      <td>13.470045</td>
      <td>15.386035</td>
      <td>14.352138</td>
      <td>16.177491</td>
      <td>15.133167</td>
    </tr>
    <tr>
      <th>max</th>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>...</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
      <td>inf</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 1240 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">eps=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span>
    <span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of clusters: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eps=6
Number of clusters: 1
Cluster sizes: [1240]

eps=7
Number of clusters: 5
Cluster sizes: [1227    4    3    3    3]

eps=8
Number of clusters: 5
Cluster sizes: [1100  130    3    4    3]

eps=9
Number of clusters: 4
Cluster sizes: [841 393   3   3]

eps=10
Number of clusters: 2
Cluster sizes: [521 719]

eps=11
Number of clusters: 2
Cluster sizes: [282 958]

eps=12
Number of clusters: 2
Cluster sizes: [ 150 1090]

eps=14
Number of clusters: 2
Cluster sizes: [  45 1195]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>For lower <code class="docutils literal notranslate"><span class="pre">eps</span></code> all images are labeled as noise.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">eps=7</span></code> we get many noise points and many small clusters.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">eps=8</span></code> and <code class="docutils literal notranslate"><span class="pre">eps=9</span></code> we get many noise points but we also get one large cluster and a few smaller clusters.</p></li>
<li><p>Starting <code class="docutils literal notranslate"><span class="pre">eps=10</span></code> we get one big cluster and noise points.</p></li>
<li><p>There is never more than one large cluster suggesting that all the images are more or less equally similar/dissimilar to the rest.</p></li>
</ul>
</section>
<section id="noise-images-identified-by-dbscan">
<h4>Noise images identified by DBSCAN<a class="headerlink" href="#noise-images-identified-by-dbscan" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique labels: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique labels: [-1  0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">print_dbscan_noise_images</span><span class="p">(</span><span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">dbscan</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We can guess why these images are noise images. There are odd angles, cropping, sunglasses, hands near faces etc.</p></li>
</ul>
<p>Let’s examine DBSCAN clusters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">min_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of clusters: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of clusters: 5
Cluster sizes: [1227    4    3    3    3]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Some clusters correspond to people with distinct faces and facial expressions.</p></li>
<li><p>It’s also capturing the orientation of the face.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">print_dbscan_clusters</span><span class="p">(</span><span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/047dab5ef5109968c8d0c737f6aebca590f770c03055fdcc78ae9f4fdf2576d9.png" src="_images/047dab5ef5109968c8d0c737f6aebca590f770c03055fdcc78ae9f4fdf2576d9.png" />
<img alt="_images/70f0c3698a8c07797b9996479c6f1cdb19614a92e964e15b3468d2b0cfcf9509.png" src="_images/70f0c3698a8c07797b9996479c6f1cdb19614a92e964e15b3468d2b0cfcf9509.png" />
<img alt="_images/a1423f7bccef6a86bf7199aec19b2bc2d55ee45b297733133cf7774c65185f8f.png" src="_images/a1423f7bccef6a86bf7199aec19b2bc2d55ee45b297733133cf7774c65185f8f.png" />
<img alt="_images/d417a3175be24d25e1eae36865f3144d0f372f35120c62a4d22d3a8cfb7e71d2.png" src="_images/d417a3175be24d25e1eae36865f3144d0f372f35120c62a4d22d3a8cfb7e71d2.png" />
<img alt="_images/98270133062bc0e158669e137200b905397af3b4b48ece2da87b0d00f00f95c7.png" src="_images/98270133062bc0e158669e137200b905397af3b4b48ece2da87b0d00f00f95c7.png" />
</div>
</div>
</section>
</section>
<section id="optional-clustering-faces-with-hierarchical-clustering">
<h3>(Optional) Clustering faces with hierarchical clustering<a class="headerlink" href="#optional-clustering-faces-with-hierarchical-clustering" title="Permalink to this heading">#</a></h3>
<p>Let’s examine the dendrogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">ward</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">no_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cluster distance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cluster distance&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s get flat clusters</span>
<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;maxclust&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hand_picked_clusters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">38</span><span class="p">]</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">print_hierarchical_clusters</span><span class="p">(</span>
    <span class="n">X_people</span><span class="p">,</span> <span class="n">y_people</span><span class="p">,</span> <span class="n">people</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">,</span> <span class="n">hand_picked_clusters</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf1695ad828acc837688e69df80c3f7d854029bd66d523542e98fac11f2ba6ce.png" src="_images/cf1695ad828acc837688e69df80c3f7d854029bd66d523542e98fac11f2ba6ce.png" />
<img alt="_images/dabf5ff5e28a7600242b88e55fbe2b661ee9308b1729d9a55d46e6aad51d1f28.png" src="_images/dabf5ff5e28a7600242b88e55fbe2b661ee9308b1729d9a55d46e6aad51d1f28.png" />
<img alt="_images/47ba89197f55a412bc68fefd4e9d8fbd28d43b6476df012b49e36ffd1c79ff16.png" src="_images/47ba89197f55a412bc68fefd4e9d8fbd28d43b6476df012b49e36ffd1c79ff16.png" />
<img alt="_images/cbabe1974a61afd5f2bcbb0364a1c1bb96ad0ada7b798fc8a9534b47433315cd.png" src="_images/cbabe1974a61afd5f2bcbb0364a1c1bb96ad0ada7b798fc8a9534b47433315cd.png" />
<img alt="_images/3744b5c203b9edec228511b4762fdead0677c821c9ee53a96f6748225b8f6b1d.png" src="_images/3744b5c203b9edec228511b4762fdead0677c821c9ee53a96f6748225b8f6b1d.png" />
<img alt="_images/1b5672a511c341b6f565f619409b62790602beb66d8da99c9a6369eb3237f8f1.png" src="_images/1b5672a511c341b6f565f619409b62790602beb66d8da99c9a6369eb3237f8f1.png" />
<img alt="_images/024ea4b9ccb37f151d47e0d6b4702a49c0bdfee3557e6df2f299f9475f15bdef.png" src="_images/024ea4b9ccb37f151d47e0d6b4702a49c0bdfee3557e6df2f299f9475f15bdef.png" />
<img alt="_images/b5c6ed42f2cf241fc1993bb1ee1b32587559dc76e6d920e7943a0aafd66f5c66.png" src="_images/b5c6ed42f2cf241fc1993bb1ee1b32587559dc76e6d920e7943a0aafd66f5c66.png" />
</div>
</div>
</section>
</section>
<section id="final-comments-summary-and-reflection">
<h2>Final comments, summary, and reflection<a class="headerlink" href="#final-comments-summary-and-reflection" title="Permalink to this heading">#</a></h2>
<section id="take-home-message">
<h3>Take-home message<a class="headerlink" href="#take-home-message" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We saw three methods for clustering: K-Means, DBSCAN, and hierarchical clustering.</p></li>
<li><p>There are many more clustering algorithms out there that we didn’t talk about. For example, see <a class="reference external" href="https://scikit-learn.org/stable/modules/clustering.html#overview-of-clustering-methods">this overview of clustering methods</a>.</p></li>
<li><p>Two important aspects of clustering</p>
<ul>
<li><p>Choice of distance metric</p></li>
<li><p>Data representation</p></li>
</ul>
</li>
<li><p>Choosing the appropriate number of clusters for a given problem is quite hard.</p></li>
<li><p>A lot of manual interpretation is involved in clustering.</p></li>
</ul>
</section>
<section id="a-few-comments-on-clustering-evaluation">
<h3>A few comments on clustering evaluation<a class="headerlink" href="#a-few-comments-on-clustering-evaluation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>If you know the ground truth, you can use metrics such as <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.adjusted_rand_score.html">adjusted random score</a> or <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.normalized_mutual_info_score.html">normalized mutual information score</a>.</p></li>
<li><p>We can’t use accuracy scores.</p>
<ul>
<li><p>Because the labels themselves are meaningless in clustering.</p></li>
</ul>
</li>
<li><p>Usually, ground truth is not available, and if it is available we would probably go with supervised models.</p></li>
</ul>
<ul class="simple">
<li><p>The silhouette score works for different clustering methods and it can give us some intuition about the quality of clusters. But it’s not very interpretable on real-world datasets.</p></li>
</ul>
<p>A couple of ways to evaluate clustering:</p>
<ul class="simple">
<li><p>Using <em>robustness-based</em> clustering metrics</p></li>
<li><p>The idea is to run a clustering algorithm or a number of clustering algorithms after adding some noise to the data or using different parameter settings and comparing outcomes.</p></li>
<li><p>If many models, perturbations, and parameters are giving the same result, the clustering is likely to be trustworthy.</p></li>
<li><p>That said, even though all clustering models give similar results, the clusters might not capture the aspect you are interested in.</p></li>
<li><p>So you cannot really avoid manual analysis!!</p></li>
</ul>
</section>
</section>
<section id="recommendation-reading-materials">
<h2>Recommendation reading materials<a class="headerlink" href="#recommendation-reading-materials" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://youtu.be/RDZUdRSDOok">Clustering with DBSCAN, Clearly Explained!!!</a></p></li>
<li><p><a class="reference external" href="https://youtu.be/7xHsRkOdVwo">StatQuest: Hierarchical Clustering</a></p></li>
<li><p>Check out this nice comparison of <a class="reference external" href="https://scikit-learn.org/stable/modules/clustering.html#overview-of-clustering-methods">sklearn clustering algorithms</a>.</p></li>
<li><p><a class="reference external" href="https://www.naftaliharris.com/blog/visualizing-dbscan-clustering/">DBSCAN Visualization</a></p></li>
<li><p><a class="reference external" href="https://dashee87.github.io/data%20science/general/Clustering-with-Scikit-with-GIFs/">Clustering with Scikit with GIFs</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="15_clustering-kmeans.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Clustering and k-means</p>
      </div>
    </a>
    <a class="right-next"
       href="17_recommender-systems.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Recommender systems</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-name-lo-a">Learning outcomes <a name="lo"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-is-not-sufficient">K-Means is not sufficient</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-recap">K-Means recap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-limitations">K-Means limitations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-limitations-shape-of-k-means-clusters">K-Means limitations: Shape of K-Means clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-1">K-Means: Failure case 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-2">K-Means: Failure case 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-failure-case-3">K-Means: Failure case 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-useful-clustering-algorithm-dbscan">Another useful clustering algorithm: DBSCAN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work">How does it work?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan-algorithm">DBSCAN algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-main-hyperparameters">Two main hyperparameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-the-eps-hyperparameter">Effect of the <code class="docutils literal notranslate"><span class="pre">eps</span></code> hyperparameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-the-min-samples-hyperparameter">Effect of the <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> hyperparameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-vs-dbscan">K-Means vs. DBSCAN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-details-on-dbscan">More details on DBSCAN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-hyperparameters-eps-and-min-samples">Illustration of hyperparameters <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-dbscan-clusters">Evaluating DBSCAN clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observations">Observations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-pros-and-cons">Summary: Pros and cons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan-failure-cases">DBSCAN: failure cases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">DBSCAN: failure cases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering">Hierarchical clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-idea">Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-hierarchical-clustering">Visualizing hierarchical clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering-input-and-output">Hierarchical clustering input and output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dendrogram">Dendrogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-plot-a-dendrogram">How to plot a dendrogram?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-do-we-mean-by-the-distance-between-clusters">What do we mean by the distance between clusters?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-linkage"><code class="docutils literal notranslate"><span class="pre">single</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-dendrogram-with-single-linkage">Creating a dendrogram with <code class="docutils literal notranslate"><span class="pre">single</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-linkage"><code class="docutils literal notranslate"><span class="pre">average</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-linkage"><code class="docutils literal notranslate"><span class="pre">complete</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ward-linkage"><code class="docutils literal notranslate"><span class="pre">ward</span></code> linkage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering-on-un-subvotes-dataset">Hierarchical clustering on UN Subvotes dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-truncation">(Optional) Truncation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flat-cluster">Flat cluster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-for-you">Questions for you</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-clustering-on-face-images">Applying clustering on face images</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-images-from-the-dataset">Example images from the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-images">Representation of images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-faces-with-k-means">Clustering faces with K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-faces-with-dbscan">Clustering faces with DBSCAN</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-eps">Tuning <code class="docutils literal notranslate"><span class="pre">eps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#noise-images-identified-by-dbscan">Noise images identified by DBSCAN</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-clustering-faces-with-hierarchical-clustering">(Optional) Clustering faces with hierarchical clustering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-summary-and-reflection">Final comments, summary, and reflection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-message">Take-home message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-few-comments-on-clustering-evaluation">A few comments on clustering evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-reading-materials">Recommendation reading materials</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>