

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Clustering and k-means &#8212; ECE 4420/6420 - latest</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '15_clustering-kmeans';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DBSCAN" href="16_dbscan_hierarchical.html" />
    <link rel="prev" title="Unsupervised learning" href="14_unsupervised-learning-pca.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    ECE 4420/6420 Machine Learning in Engineering
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro.html">Introduction to machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_decision-trees.html">Machine learning concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_ml-fundamentals.html">Machine learning fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_kNNs.html">k-Nearest Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_preprocessing-pipelines.html">Preprocessing and <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="06_column-transformer-text-feats.html"><code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> and text data</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_linear-models.html">Linear models</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_hyperparameter-optimization.html">Hyperparameter optimization and optimization bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_classification-metrics.html">Classification evaluation metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_regression-metrics.html">Regression evaluation metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_ensembles.html">Ensemble learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_multiclass-neuralnetwork.html">Multi-learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_unsupervised-learning-pca.html">Unsupervised learning</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Clustering and k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_dbscan_hierarchical.html">DBSCAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_recommender-systems.html">Recommender systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="22_ethics.html">Machine learning fairness</a></li>
<li class="toctree-l1"><a class="reference internal" href="23_feat-importances-xai.html">ML explainability</a></li>
<li class="toctree-l1"><a class="reference internal" href="30_course-review.html">Course review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Things you should know</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="a01_syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="a02_final_project.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="a03_setup.html">Setup</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Attribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="b01_attribution.html">Attributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="b02_LICENSE.html">LICENSE</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/15_clustering-kmeans.ipynb" download="15_clustering-kmeans.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Clustering and k-means</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-name-lo-a">Learning outcomes <a name="lo"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-motivation">Clustering motivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-clustering">Why clustering?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-and-possible-output">Input and possible output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-notion-of-correct-grouping">Is there a notion of “correct” grouping?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meaningful-groups-in-clustering">Meaningful groups in clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications-data-exploration">Common applications: Data exploration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications-customer-segmentation">Common applications: Customer segmentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#document-clustering">Document clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#similarity-and-distances">Similarity and distances</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-algorithm">K-Means clustering algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstration-of-k-means">Demonstration of K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-visualization">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-using-sklearn">K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kmeans-fit"><code class="docutils literal notranslate"><span class="pre">KMeans</span></code> <code class="docutils literal notranslate"><span class="pre">fit</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-of-kmeans"><code class="docutils literal notranslate"><span class="pre">predict</span></code> of <code class="docutils literal notranslate"><span class="pre">KMeans</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-centers-in-k-means">Cluster centers in  K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-predictions-on-new-examples">K-Means predictions on new examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-algorithm-main-idea">K-Means algorithm: Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">K-Means clustering algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-process">Iterative process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-the-closest-centers">How to find the closest centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">How to find the closest centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-update-centers">How to update centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-1-step-1">Iteration 1: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-1-step-2">Iteration 1: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-2-step-1">Iteration 2: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-2-step-2">Iteration 2: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-3-step-1">Iteration 3: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-3-step-2">Iteration 3: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-4-step-1">Iteration 4: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-4-step-2">Iteration 4: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-5-step-1">Iteration 5: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-5-step-2">Iteration 5: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-stop">When to stop?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Example 2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Initialization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-feature-engineering-using-k-means">(Optional) Feature engineering using K-Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-k-a-name-3-center-a">Choosing K <a name="3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-tuning-for-k">Hyperparameter tuning for K</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-elbow-method">Method 1: The Elbow method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inertia">Inertia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-silhouette-method">Method 2: The Silhouette method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-intra-cluster-distance-a">Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-cluster-distance-b">Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-distance-for-a-sample">Silhouette distance for a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-silhouette-scores-to-select-the-number-of-clusters">Using Silhouette scores to select the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-look-for-in-these-plots">What to look for in these plots?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-on-silhouette-scores">Comments on Silhouette scores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-true-false-questions">K-Means: True/False questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">K-Means: True/False questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-case-study-customer-segmentation">K-Means case study: Customer segmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-customer-segmentation">What is customer segmentation?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#business-problem">Business problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-on-the-dataset">Information on the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminary-eda">Preliminary EDA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-exercises-for-you">Practice exercises for you</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-exercises-for-you-answers">Mini exercises for you (Answers)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-types-and-preprocessing">Feature types and preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-the-hyperparameter-n-clusters">Tuning the hyperparameter <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-interpretation">Cluster interpretation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transactors">Transactors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#revolvers">Revolvers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vip-prime">VIP/Prime</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-activity">Low activity</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-the-interpretation-of-clusters">More on the interpretation of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-exercise-for-you">Practice exercise for you</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-and-summary">Final comments and summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-comment-on-initialization">A comment on initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bad-initialization">Example: Bad initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-better-initialization">Example: Better initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-we-do-about-it">What can we do about it?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-to-remember">Important points to remember</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Important points to remember</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Important points to remember</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-reading-materials">Recommendation reading materials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="clustering-and-k-means">
<h1>Clustering and k-means<a class="headerlink" href="#clustering-and-k-means" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Update: 2023</p></li>
<li><p>Duration: 75 minutes</p></li>
</ul>
<hr><section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">cmle</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">make_column_transformer</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">KElbowVisualizer</span><span class="p">,</span> <span class="n">SilhouetteVisualizer</span>


<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
<section id="learning-outcomes-a-name-lo-a">
<h2>Learning outcomes <a name="lo"></a><a class="headerlink" href="#learning-outcomes-a-name-lo-a" title="Permalink to this heading">#</a></h2>
<p>From this lecture, students are expected to be able to:</p>
<ul class="simple">
<li><p>Explain the motivation and potential applications of clustering.</p></li>
<li><p>Define the clustering problem.</p></li>
<li><p>Explain the K-Means algorithm.</p></li>
<li><p>Apply <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> algorithm.</p></li>
<li><p>Apply the Elbow method and Silhouette method to choose the number of clusters.</p></li>
<li><p>Use clustering for customer segmentation problems.</p></li>
<li><p>Interpret the clusters discovered by K-Means.</p></li>
</ul>
</section>
<section id="clustering-motivation">
<h2>Clustering motivation<a class="headerlink" href="#clustering-motivation" title="Permalink to this heading">#</a></h2>
<section id="why-clustering">
<h3>Why clustering?<a class="headerlink" href="#why-clustering" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Most of the data out there is unlabeled.</p></li>
<li><p>Getting labeled training data is often difficult, expensive, or simply impossible in some cases.</p></li>
<li><p>Can we extract some useful information from unlabeled data?</p></li>
<li><p>The most intuitive way is to group similar examples to get some insight into the data even though we do not have the targets.</p></li>
</ul>
</section>
<section id="clustering">
<h3>Clustering<a class="headerlink" href="#clustering" title="Permalink to this heading">#</a></h3>
<p><strong>Clustering</strong> is the task of partitioning the dataset into groups called clusters.</p>
<p>The goal of clustering is to discover underlying groups in a given dataset such that:</p>
<ul class="simple">
<li><p>examples in the same group are as similar as possible;</p></li>
<li><p>examples in different groups are as different as possible.</p></li>
</ul>
</section>
<section id="input-and-possible-output">
<h3>Input and possible output<a class="headerlink" href="#input-and-possible-output" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f421a5a7520&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421a5a77c0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421a5a7a60&gt;]
</pre></div>
</div>
<img alt="_images/8e9b7cc947d62a782a83a573c708c5a85efa07e145b7352bf77c77d85cbc7d7f.png" src="_images/8e9b7cc947d62a782a83a573c708c5a85efa07e145b7352bf77c77d85cbc7d7f.png" />
</div>
</div>
<p>Think of clustering as coloring the points (e.g., blue, red, green) such that points with the same color are close to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f421a50c820&gt;
</pre></div>
</div>
<img alt="_images/46cf9c9d32b6adfff96794d3b361e252f1d63e713d051533795fc7f5e10635ef.png" src="_images/46cf9c9d32b6adfff96794d3b361e252f1d63e713d051533795fc7f5e10635ef.png" />
</div>
</div>
<ul class="simple">
<li><p>Usually, the clusters are identified by a <strong>cluster label</strong>.</p></li>
<li><p>These labels are arbitrary, and relabeling the points (label switching) does not make a difference.</p></li>
<li><p>What we care about is which points have the same labels and which ones have different labels.</p></li>
</ul>
</section>
<section id="is-there-a-notion-of-correct-grouping">
<h3>Is there a notion of “correct” grouping?<a class="headerlink" href="#is-there-a-notion-of-correct-grouping" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Very often we do not know how many clusters are there in the data or if there are any clusters at all. In real-world data, clusters are rarely as clear as in our toy example above.</p></li>
<li><p>There is a notion of coherent and optimal (in some sense) clusters but there is no absolute truth here.</p></li>
</ul>
</section>
<section id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">#</a></h3>
<p>Which of the following groups of emoticons is the “correct” grouping?</p>
<!-- ![emoticon_clustering_example.png](img/emoticon_clustering_example.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/emoticon_clustering_example.png" alt="emoticon_clustering_example.png" height="800" width="800"></center>
<p>Both seem reasonable!</p>
</section>
<section id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">#</a></h3>
<p>How would you group a deck of cards?</p>
<!-- ![cards_deck.png](img/cards_deck.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/cards_deck.png" alt="cards_deck.png" width="30%"></center>
<ul class="simple">
<li><p>In a deck of cards:</p>
<ol class="arabic simple">
<li><p>We have two colors: black and <font color="red">red</font>;</p></li>
<li><p>We have four suits: Clubs, Spades, <font color="red">Hearts</font>, and <font color="red">Diamonds</font>;</p></li>
<li><p>We have 13 values: <span class="math notranslate nohighlight">\(\left\{A,2,3,4,5,6,7,8,9,10,J,Q,K\right\}\)</span>.</p></li>
</ol>
</li>
<li><p>What are the “true” clusters here?</p></li>
</ul>
<p>Should we cluster by suits: Clubs, Spades, <font color="red">Hearts</font>, and <font color="red">Diamonds</font>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_deck</span><span class="p">(</span><span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;suits&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4679dafe3b916d8644ea2dbf8fb64e62c21a09c07da797910feb189403cefc25.png" src="_images/4679dafe3b916d8644ea2dbf8fb64e62c21a09c07da797910feb189403cefc25.png" />
</div>
</div>
<p>Should we cluster by colors?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_deck</span><span class="p">(</span><span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9b841aae48002cda8a30b27ba1697d5372eb6273224e245148267ff863fd63b.png" src="_images/b9b841aae48002cda8a30b27ba1697d5372eb6273224e245148267ff863fd63b.png" />
</div>
</div>
<p>Should we cluster by value?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_deck</span><span class="p">(</span><span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;cards&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc69efd720560ce1ffaceac9e78a639f0f614c45db641d0893209a9f34457816.png" src="_images/dc69efd720560ce1ffaceac9e78a639f0f614c45db641d0893209a9f34457816.png" />
</div>
</div>
<ul class="simple">
<li><p>All these options seem reasonable.</p></li>
</ul>
</section>
<section id="meaningful-groups-in-clustering">
<h3>Meaningful groups in clustering<a class="headerlink" href="#meaningful-groups-in-clustering" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In clustering, meaningful groups are dependent on the <strong>application</strong>.</p></li>
<li><p>It usually helps if we have some prior knowledge about the data and the problem.</p></li>
<li><p>This makes it hard for us to objectively measure the quality of a clustering algorithm (or think about “true” clusters).</p></li>
</ul>
</section>
<section id="common-applications-data-exploration">
<h3>Common applications: Data exploration<a class="headerlink" href="#common-applications-data-exploration" title="Permalink to this heading">#</a></h3>
<p>Although there is no notion of the “right” answer, we might still get something useful out of clustering. There are a number of common applications for clustering.</p>
<ul class="simple">
<li><p>Summarize or compress data.</p></li>
<li><p>Partition the data into groups before further processing.</p></li>
<li><p>For instance, you could use it in a supervised learning setting as follows. Carry out clustering and examine the performance of your model on individual clusters. If the performance is lower on a particular cluster, you could either try building a separate model for that cluster and improve the overall performance of your supervised model.</p></li>
</ul>
</section>
<section id="common-applications-customer-segmentation">
<h3>Common applications: Customer segmentation<a class="headerlink" href="#common-applications-customer-segmentation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Understand the landscape of the market in businesses and craft targeted business or marketing strategies tailored for each group.</p></li>
</ul>
<!-- ![emoticon_clustering_example.png](img/emoticon_clustering_example.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/emoticon_clustering_example.png" alt="emoticon_clustering_example.png" height="600" width="600"></center>
<p><a class="reference external" href="https://www.youtube.com/watch?v=zPJtDohab-g&amp;t=134s">source</a></p>
</section>
<section id="document-clustering">
<h3>Document clustering<a class="headerlink" href="#document-clustering" title="Permalink to this heading">#</a></h3>
<p>Grouping articles on different topics from different news sources. For example, <a class="reference external" href="https://news.google.com">Google News</a>.</p>
<!-- ![google_news.png](img/google_news.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/google_news.png" alt="google_news.png" width="60%"></center></section>
<section id="similarity-and-distances">
<h3>Similarity and distances<a class="headerlink" href="#similarity-and-distances" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Clustering is based on the notion of similarity or distances between points.</p></li>
<li><p>How do we determine the similarity between points in a multi-dimensional space?</p></li>
<li><p>Can we use something like <span class="math notranslate nohighlight">\(k\)</span>-neighbours for similarity?</p>
<ul>
<li><p>Yes! That’s a good start!</p></li>
<li><p>With <span class="math notranslate nohighlight">\(k\)</span>-neighbours we used Euclidean distances to find nearby points.</p></li>
<li><p>We can use the same idea for clustering!</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="k-means-clustering-algorithm">
<h2>K-Means clustering algorithm<a class="headerlink" href="#k-means-clustering-algorithm" title="Permalink to this heading">#</a></h2>
<section id="k-means-clustering">
<h3>K-Means clustering<a class="headerlink" href="#k-means-clustering" title="Permalink to this heading">#</a></h3>
<p>One of the most commonly used clustering algorithms.</p>
<p><strong>Input</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> a set of data points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> (or <span class="math notranslate nohighlight">\(k\)</span> or <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code>) <span class="math notranslate nohighlight">\(\rightarrow\)</span> number of clusters</p></li>
</ul>
<p><strong>Output</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> clusters (groups) of the data points</p></li>
</ul>
</section>
<section id="demonstration-of-k-means">
<h3>Demonstration of K-Means<a class="headerlink" href="#demonstration-of-k-means" title="Permalink to this heading">#</a></h3>
<!-- ![kmeans.png](img/kmeans.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/kmeans.png" alt="kmeans.png" width="80%"></center></section>
<section id="k-means-visualization">
<h3>K-Means Visualization<a class="headerlink" href="#k-means-visualization" title="Permalink to this heading">#</a></h3>
<!-- ![kmeans_vis1.png](img/kmeans_vis1.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/kmeans_vis1.png" alt="kmeans_vis1.png" width="50%"></center></section>
<section id="id1">
<h3>K-Means Visualization<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<!-- ![kmeans_vis.gif](img/kmeans_vis.gif) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/kmeans_vis.gif" alt="kmeans_vis.gif" width="50%"></center></section>
<section id="id2">
<h3>K-Means Visualization<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<!-- ![kmeans_vis35.png](img/kmeans_vis35.png) -->
<center><img src="https://yongkaw.people.clemson.edu/ece4420/img/kmeans_vis35.png" alt="kmeans_vis35.png" width="50%"></center></section>
<section id="k-means-using-sklearn">
<h3>K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code><a class="headerlink" href="#k-means-using-sklearn" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Before understanding the algorithm, let’s try it with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p></li>
<li><p>Consider the toy dataset above.</p></li>
<li><p>For this toy dataset, the three clusters are pretty clear.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f4211ed8910&gt;]
</pre></div>
</div>
<img alt="_images/4b95c7d2a492cdd5fa7706668c645ce9a6d8fbae3b8c80d46ee7915b9df1ca67.png" src="_images/4b95c7d2a492cdd5fa7706668c645ce9a6d8fbae3b8c80d46ee7915b9df1ca67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  5.69192445,  -9.47641249],
       [  1.70789903,   6.00435173],
       [  0.23621041,  -3.11909976],
       [  2.90159483,   5.42121526],
       [  5.85943906,  -8.38192364],
       [  6.04774884, -10.30504657],
       [ -2.00758803,  -7.24743939],
       [  1.45467725,  -6.58387198],
       [  1.53636249,   5.11121453],
       [  5.4307043 ,  -9.75956122]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feat1&quot;</span><span class="p">,</span> <span class="s2">&quot;feat2&quot;</span><span class="p">])</span>
<span class="n">toy_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feat1</th>
      <th>feat2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.691924</td>
      <td>-9.476412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.707899</td>
      <td>6.004352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.236210</td>
      <td>-3.119100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.901595</td>
      <td>5.421215</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.859439</td>
      <td>-8.381924</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.047749</td>
      <td>-10.305047</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.007588</td>
      <td>-7.247439</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.454677</td>
      <td>-6.583872</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.536362</td>
      <td>5.111215</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5.430704</td>
      <td>-9.759561</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="kmeans-fit">
<h3><code class="docutils literal notranslate"><span class="pre">KMeans</span></code> <code class="docutils literal notranslate"><span class="pre">fit</span></code><a class="headerlink" href="#kmeans-fit" title="Permalink to this heading">#</a></h3>
<p>Let’s try <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> algorithm on this dataset.</p>
<ul class="simple">
<li><p>We need to decide how many clusters we want. Here we are passing 3.</p></li>
<li><p>We are only passing <code class="docutils literal notranslate"><span class="pre">X</span></code> because this is unsupervised learning; we do not have labels.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># We are only passing X because this is unsupervised learning</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=3)</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="predict-of-kmeans">
<h3><code class="docutils literal notranslate"><span class="pre">predict</span></code> of <code class="docutils literal notranslate"><span class="pre">KMeans</span></code><a class="headerlink" href="#predict-of-kmeans" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The output of <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> is <span class="math notranslate nohighlight">\(K\)</span> clusters (groups) of the data points.</p></li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">predict</span></code> will give us the cluster assignment for each data point.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 1, 0, 1, 2, 2, 0, 0, 1, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toy_df_cl</span> <span class="o">=</span> <span class="n">toy_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">toy_df_cl</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">toy_df</span><span class="p">)</span>
<span class="n">toy_df_cl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feat1</th>
      <th>feat2</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.691924</td>
      <td>-9.476412</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.707899</td>
      <td>6.004352</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.236210</td>
      <td>-3.119100</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.901595</td>
      <td>5.421215</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.859439</td>
      <td>-8.381924</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.047749</td>
      <td>-10.305047</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.007588</td>
      <td>-7.247439</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.454677</td>
      <td>-6.583872</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.536362</td>
      <td>5.111215</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5.430704</td>
      <td>-9.759561</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="cluster-centers-in-k-means">
<h3>Cluster centers in  K-Means<a class="headerlink" href="#cluster-centers-in-k-means" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In K-Means, each cluster is represented by its cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.10556679, -5.65013704],
       [ 2.04861878,  5.51226051],
       [ 5.75745416, -9.48073598]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span>
                         <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f421227d2a0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421227d570&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421227d810&gt;]
</pre></div>
</div>
<img alt="_images/9ce3d2302ca19cfe4af04a4cbab307cd2e1ca57a427c5ebf47cccb6e5846fe15.png" src="_images/9ce3d2302ca19cfe4af04a4cbab307cd2e1ca57a427c5ebf47cccb6e5846fe15.png" />
</div>
</div>
</section>
<section id="k-means-predictions-on-new-examples">
<h3>K-Means predictions on new examples<a class="headerlink" href="#k-means-predictions-on-new-examples" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We can also use <code class="docutils literal notranslate"><span class="pre">predict</span></code> on unseen examples!</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_examples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]])</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_examples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">new_examples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">new_examples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span>
                         <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f421211dea0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421211e140&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f421211e3e0&gt;]
</pre></div>
</div>
<img alt="_images/36fd25c0fb3055df795889cb0e4b0b14e4458642f69bc409eaf09bade4768e23.png" src="_images/36fd25c0fb3055df795889cb0e4b0b14e4458642f69bc409eaf09bade4768e23.png" />
</div>
</div>
</section>
<section id="k-means-algorithm-main-idea">
<h3>K-Means algorithm: Main idea<a class="headerlink" href="#k-means-algorithm-main-idea" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Represent each cluster by its cluster center and assign a cluster membership to each data point.</p></li>
</ul>
<p><strong>Chicken-and-egg problem!</strong></p>
<ul class="simple">
<li><p>If we knew cluster centers, we could simply assign each point to its nearest center.</p></li>
<li><p>Similarly, if we knew the assignments, we could calculate cluster centers.</p></li>
<li><p>But we do not know either.</p></li>
</ul>
<p>A usual computer science answer to such problems is iterations!!</p>
</section>
<section id="id3">
<h3>K-Means clustering algorithm<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p><strong>Input</strong>: Data points X and the number of clusters K</p>
<p><strong>Initialization</strong>: K initial centers for the clusters</p>
<p><strong>Iterative process</strong>:</p>
<p>repeat</p>
<ul class="simple">
<li><p>Assign each example to the closest center.</p></li>
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<p>until <strong>centers stop changing</strong> or <strong>maximum iterations have been reached</strong>.</p>
<p>Let’s execute the K-Means algorithm on our toy example.</p>
<p><strong>Input</strong></p>
<ul class="simple">
<li><p>The data points <code class="docutils literal notranslate"><span class="pre">X</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_examples</span> <span class="o">=</span> <span class="n">toy_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of examples: &quot;</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of examples:  10
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  5.69192445,  -9.47641249],
       [  1.70789903,   6.00435173],
       [  0.23621041,  -3.11909976],
       [  2.90159483,   5.42121526],
       [  5.85943906,  -8.38192364],
       [  6.04774884, -10.30504657],
       [ -2.00758803,  -7.24743939],
       [  1.45467725,  -6.58387198],
       [  1.53636249,   5.11121453],
       [  5.4307043 ,  -9.75956122]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Let K (number of clusters) be 3.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Random initialization for K initial centers of the clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">centers_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">centers_df</span> <span class="o">=</span> <span class="n">toy_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">centers_idx</span><span class="p">]</span>
<span class="n">centers</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">centers_idx</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colours</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Initial centers&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Initial centers&#39;)
</pre></div>
</div>
<img alt="_images/9ac1929551aa3d8a42c6218b39a5b68ad62284c6d92724a4634098b4753a3a57.png" src="_images/9ac1929551aa3d8a42c6218b39a5b68ad62284c6d92724a4634098b4753a3a57.png" />
</div>
</div>
</section>
<section id="iterative-process">
<h3>Iterative process<a class="headerlink" href="#iterative-process" title="Permalink to this heading">#</a></h3>
<p>repeat</p>
<ul class="simple">
<li><p>Assign each example to the closest center. (<code class="docutils literal notranslate"><span class="pre">update_Z</span></code>)</p></li>
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster. (<code class="docutils literal notranslate"><span class="pre">update_centers</span></code>)</p></li>
</ul>
<p>until <strong>centers stop changing</strong> or <strong>maximum iterations have been reached</strong>.</p>
</section>
<section id="how-to-find-the-closest-centers">
<h3>How to find the closest centers?<a class="headerlink" href="#how-to-find-the-closest-centers" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The first step in the iterative process is assigning examples to the closest center.</p></li>
<li><p>Let’s consider the distance of an example to all centers and assign that example to the closest center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_example_dist</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">centers_df</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/783a8ae0815e69dae95364b5b6cb686fc4f84b47684fae656765e2e32d116e5e.png" src="_images/783a8ae0815e69dae95364b5b6cb686fc4f84b47684fae656765e2e32d116e5e.png" />
</div>
</div>
</section>
<section id="id4">
<h3>How to find the closest centers?<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Similarly, we can make cluster assignments for all points by calculating the distances of all examples to the centers and assigning them to the cluster with the smallest distance.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>


<span class="k">def</span> <span class="nf">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns distances and updated cluster assignments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">euclidean_distances</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-to-update-centers">
<h3>How to update centers?<a class="headerlink" href="#how-to-update-centers" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>With the new cluster assignments for our data points, we update cluster centers.</p></li>
<li><p>New cluster centers are means of data points in each cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">old_centers</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns new centers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_centers</span> <span class="o">=</span> <span class="n">old_centers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">new_centers</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Z</span> <span class="o">==</span> <span class="n">kk</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_centers</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="iteration-1-step-1">
<h3>Iteration 1: Step 1<a class="headerlink" href="#iteration-1-step-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assign each example to the closest cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 2, 0, 2, 2, 1, 2, 0, 2])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is the current cluster assignment.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_current_assinment</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/29e5d3ccf943f147f4ca22be162319d3b058e3df4ad2b9b83597349062648a58.png" src="_images/29e5d3ccf943f147f4ca22be162319d3b058e3df4ad2b9b83597349062648a58.png" />
</div>
</div>
</section>
<section id="iteration-1-step-2">
<h3>Iteration 1: Step 2<a class="headerlink" href="#iteration-1-step-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_centers_it1</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is how the centers moved in this iteration.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_update_centroid</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">new_centers_it1</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/293aec88ff4a628e9b7d30dda941894e6ccb4c659db8cbe6c75ec3030f030af0.png" src="_images/293aec88ff4a628e9b7d30dda941894e6ccb4c659db8cbe6c75ec3030f030af0.png" />
</div>
</div>
</section>
<section id="iteration-2-step-1">
<h3>Iteration 2: Step 1<a class="headerlink" href="#iteration-2-step-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assign each example to the closest cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_centers_it1</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 1, 0, 2, 2, 1, 2, 0, 2])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is the current cluster assignment.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_current_assinment</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/859efc35a4e40243505178bb627be657596e48f42b22ddbe59c68e941d1cd8ce.png" src="_images/859efc35a4e40243505178bb627be657596e48f42b22ddbe59c68e941d1cd8ce.png" />
</div>
</div>
</section>
<section id="iteration-2-step-2">
<h3>Iteration 2: Step 2<a class="headerlink" href="#iteration-2-step-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_centers_it2</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it1</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is how the centers moved in this iteration.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_update_centroid</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">new_centers_it2</span><span class="p">,</span> <span class="n">new_centers_it1</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a65a14681317b554e3215e7dcfe1ab6644d207836337e8edfb5e80d47c0c9034.png" src="_images/a65a14681317b554e3215e7dcfe1ab6644d207836337e8edfb5e80d47c0c9034.png" />
</div>
</div>
</section>
<section id="iteration-3-step-1">
<h3>Iteration 3: Step 1<a class="headerlink" href="#iteration-3-step-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assign each example to the closest cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_centers_it2</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 1, 0, 2, 2, 1, 1, 0, 2])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is the current cluster assignment.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_current_assinment</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c67fa65f7ec78a19ffef34c5c9e9966ecebe52b3de2583ade79c79f7952d7e5b.png" src="_images/c67fa65f7ec78a19ffef34c5c9e9966ecebe52b3de2583ade79c79f7952d7e5b.png" />
</div>
</div>
</section>
<section id="iteration-3-step-2">
<h3>Iteration 3: Step 2<a class="headerlink" href="#iteration-3-step-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_centers_it3</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it2</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is how the centers moved in this iteration.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_update_centroid</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">new_centers_it3</span><span class="p">,</span> <span class="n">new_centers_it2</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e9d897b371efb0bf6658ac44afa40272853b0b972924972fc974000f679ff28a.png" src="_images/e9d897b371efb0bf6658ac44afa40272853b0b972924972fc974000f679ff28a.png" />
</div>
</div>
</section>
<section id="iteration-4-step-1">
<h3>Iteration 4: Step 1<a class="headerlink" href="#iteration-4-step-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assign each example to the closest cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_centers_it3</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 1, 0, 2, 2, 1, 1, 0, 2])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is the current cluster assignment.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_current_assinment</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6143d3e4599716d4ac2e81f5bcb2331052ea5711c1a9d99678cbb70927d792ef.png" src="_images/6143d3e4599716d4ac2e81f5bcb2331052ea5711c1a9d99678cbb70927d792ef.png" />
</div>
</div>
</section>
<section id="iteration-4-step-2">
<h3>Iteration 4: Step 2<a class="headerlink" href="#iteration-4-step-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_centers_it4</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it3</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The cluster centers are not moving anymore.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_update_centroid</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">new_centers_it4</span><span class="p">,</span> <span class="n">new_centers_it3</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36cba4c84282c39a43b2fae117ad61124f8a298af58b546ca292060cd4c9218a.png" src="_images/36cba4c84282c39a43b2fae117ad61124f8a298af58b546ca292060cd4c9218a.png" />
</div>
</div>
</section>
<section id="iteration-5-step-1">
<h3>Iteration 5: Step 1<a class="headerlink" href="#iteration-5-step-1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assign each example to the closest cluster center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_centers_it4</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 0, 1, 0, 2, 2, 1, 1, 0, 2])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This is the current cluster assignment.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_current_assinment</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6143d3e4599716d4ac2e81f5bcb2331052ea5711c1a9d99678cbb70927d792ef.png" src="_images/6143d3e4599716d4ac2e81f5bcb2331052ea5711c1a9d99678cbb70927d792ef.png" />
</div>
</div>
</section>
<section id="iteration-5-step-2">
<h3>Iteration 5: Step 2<a class="headerlink" href="#iteration-5-step-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Estimate new centers as the <em>average</em> of observations in a cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_centers_it5</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">new_centers_it4</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The cluster centers are not moving anymore.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_update_centroid</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">new_centers_it5</span><span class="p">,</span> <span class="n">new_centers_it4</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36cba4c84282c39a43b2fae117ad61124f8a298af58b546ca292060cd4c9218a.png" src="_images/36cba4c84282c39a43b2fae117ad61124f8a298af58b546ca292060cd4c9218a.png" />
</div>
</div>
</section>
<section id="when-to-stop">
<h3>When to stop?<a class="headerlink" href="#when-to-stop" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Seems like our centroids aren’t changing anymore.</p></li>
<li><p>The algorithm has converged. So we stop!</p></li>
<li><p>K-Means always converges. It doesn’t mean it finds the “right” clusters. It can converge to a sub-optimal solution.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_iterative</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cad5dc94072d6be4976f46af6f6136d5d4801a82ee3dd7b77b4fb2eec865daaa.png" src="_images/cad5dc94072d6be4976f46af6f6136d5d4801a82ee3dd7b77b4fb2eec865daaa.png" />
</div>
</div>
<p>Initialization is crucial. We’ll talk about it in a bit.</p>
</section>
<section id="id5">
<h3>Example 2<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s use the K-means on the iris dataset.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>  <span class="c1"># loading the iris dataset</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># get the input data</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span>
    <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="p">]</span>  <span class="c1"># get the targets, in this case the types of the Iris flower</span>

<span class="n">iris_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">iris_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;setosa&#39;, &#39;versicolor&#39;, &#39;virginica&#39;], dtype=&#39;&lt;U10&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reducing the dimensionality for plotting purposes</span>
<span class="c1"># (We&#39;re going to learn more about it later in the course)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">data_iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;$Z_1$&quot;</span><span class="p">,</span> <span class="s2">&quot;$Z_2$&quot;</span><span class="p">])</span>
<span class="n">data_iris</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_unsup</span><span class="p">(</span><span class="n">data_iris</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;Iris dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/76c6522e15426631ed7d717c3a446c1d53c3ed3bcff7220c2abbe42f32eb5ddb.png" src="_images/76c6522e15426631ed7d717c3a446c1d53c3ed3bcff7220c2abbe42f32eb5ddb.png" />
</div>
</div>
<section id="id6">
<h4>Initialization<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>In this case, we know that <span class="math notranslate nohighlight">\(k=3\)</span>;</p></li>
<li><p>We are going to pick three points at random to use as initial centroids;</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RANDOM initialization</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">data_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_intial_center</span><span class="p">(</span><span class="n">data_iris</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Iris dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/511442729d7d9b877b8a6e7e2875b54216d17ba1e0c8aa24e208b58bbd12158f.png" src="_images/511442729d7d9b877b8a6e7e2875b54216d17ba1e0c8aa24e208b58bbd12158f.png" />
</div>
</div>
<ul class="simple">
<li><p>Next, for each point in the dataset, we calculate the distance to each one of the centroids;</p></li>
<li><p>Let’s do it for one point as an example:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_example_dist</span><span class="p">(</span><span class="n">data_iris</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/22a27a1b1474d2c82b89363c3a7070e55064a8beaa43ea7e1bef678ffc7bcd5c.png" src="_images/22a27a1b1474d2c82b89363c3a7070e55064a8beaa43ea7e1bef678ffc7bcd5c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">cmle</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">data_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">centroids</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cmle</span><span class="o">.</span><span class="n">plot_first_assignment</span><span class="p">(</span><span class="n">data_iris</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4d3858e90d1c52c4fda22132eae3f003d2d84e42a9914f4056ba1825cb898945.png" src="_images/4d3858e90d1c52c4fda22132eae3f003d2d84e42a9914f4056ba1825cb898945.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_iterative</span><span class="p">(</span><span class="n">data_iris</span><span class="p">,</span> <span class="n">centroids</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/73e21d371004953a88cdd910341303cefda4f018f44441f839840f5eb1c520c3.png" src="_images/73e21d371004953a88cdd910341303cefda4f018f44441f839840f5eb1c520c3.png" />
</div>
</div>
</section>
</section>
<section id="optional-feature-engineering-using-k-means">
<h3>(Optional) Feature engineering using K-Means<a class="headerlink" href="#optional-feature-engineering-using-k-means" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>K-Means could be used for feature engineering in supervised learning.</p></li>
<li><p>Examples:</p>
<ul>
<li><p>You could add a categorical feature: cluster membership</p></li>
<li><p>You could add a continuous feature: distance from each cluster center</p></li>
</ul>
</li>
<li><p>See <a class="reference external" href="http://ai.stanford.edu/~acoates/papers/coatesleeng_aistats_2011.pdf">this paper</a>.</p></li>
</ul>
<p><br><br><br><br></p>
</section>
</section>
<section id="choosing-k-a-name-3-center-a">
<h2>Choosing K <a name="3"></center></a><a class="headerlink" href="#choosing-k-a-name-3-center-a" title="Permalink to this heading">#</a></h2>
<section id="hyperparameter-tuning-for-k">
<h3>Hyperparameter tuning for K<a class="headerlink" href="#hyperparameter-tuning-for-k" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>K-Means takes K (<code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>) as a hyperparameter. How do we pick K?</p></li>
<li><p>In the supervised setting we carried out hyperparameter optimization based on cross-validation scores.</p></li>
<li><p>Since in unsupervised learning, we do not have the target values, it becomes difficult to objectively measure the effectiveness of the algorithms.</p></li>
<li><p>There is no definitive approach.</p></li>
<li><p>However, some strategies might be useful to help you determine K.</p></li>
</ul>
</section>
<section id="method-1-the-elbow-method">
<h3>Method 1: The Elbow method<a class="headerlink" href="#method-1-the-elbow-method" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>This method looks at the sum of <strong>intra-cluster distances</strong>, which is also referred to as <strong>inertia</strong>.</p></li>
<li><p>The intra-cluster distance in our toy example above is given as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \sum_{P_i \in C_1}  distance(P_i, C_1)^2 + \sum_{P_i \in C_2}  distance(P_i, C_2)^2 + \sum_{P_i \in C_3} distance(P_i, C_3)^2\]</div>
<p>Where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_1, C_2, C_3\)</span> are centroids</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i\)</span>s are points within that cluster</p></li>
<li><p><span class="math notranslate nohighlight">\(distance\)</span> is the usual Euclidean distance.</p></li>
</ul>
</section>
<section id="inertia">
<h3>Inertia<a class="headerlink" href="#inertia" title="Permalink to this heading">#</a></h3>
<p>You can access this intra-cluster distance or inertia as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f4207eca380&gt;]
</pre></div>
</div>
<img alt="_images/09f2d44b55070a59df30c44d13a6276fd8eec24bf5282b50ca6a4eeeab11ac1c.png" src="_images/09f2d44b55070a59df30c44d13a6276fd8eec24bf5282b50ca6a4eeeab11ac1c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;inertia&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;inertia&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>K</th>
      <th>inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4372.460950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>58.474524</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>26.900485</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31</td>
      <td>12.770892</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>6.421834</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51</td>
      <td>3.593682</td>
    </tr>
    <tr>
      <th>6</th>
      <td>61</td>
      <td>1.961654</td>
    </tr>
    <tr>
      <th>7</th>
      <td>71</td>
      <td>0.945421</td>
    </tr>
    <tr>
      <th>8</th>
      <td>81</td>
      <td>0.322479</td>
    </tr>
    <tr>
      <th>9</th>
      <td>91</td>
      <td>0.053156</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The inertia decreases as K increases.</p></li>
<li><p>Question: Do we want inertia to be small or large?</p></li>
<li><p>The problem is that we can’t just look for a <span class="math notranslate nohighlight">\(k\)</span> that minimizes inertia because it decreases as <span class="math notranslate nohighlight">\(k\)</span> increases.</p>
<ul>
<li><p>If I have the number of clusters = the number of examples, each example will have its own cluster and the intra-cluster distance will be 0.</p></li>
</ul>
</li>
<li><p>Instead, we evaluate the trade-off: “small k” vs “small intra-cluster distances”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_elbow</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">inertia_values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">inertia_values</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Inertia&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">inertia_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">toy_df</span><span class="p">)</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
<span class="n">plot_elbow</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">inertia_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f6794cffeaa527b9d4950fb6027c0ecfbee06ca61e327cd8a23332c8ffaf0824.png" src="_images/f6794cffeaa527b9d4950fb6027c0ecfbee06ca61e327cd8a23332c8ffaf0824.png" />
</div>
</div>
<ul class="simple">
<li><p>From the above plot, we could argue that three clusters (the point of inflection on the curve) are enough.</p></li>
<li><p>The inertia decreases when clusters are greater than 3. However, it’s not a big improvement and so we prefer K=3.</p></li>
<li><p>In this toy example, it’s the plot is kind of clear and easy to interpret but it can be hard to interpret in real-life examples.</p></li>
</ul>
<p>There is a package called <a class="reference external" href="https://www.scikit-yb.org/en/latest/api/cluster/elbow.html"><code class="docutils literal notranslate"><span class="pre">yellowbrick</span></code></a> which can be used to create these plots conveniently.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">yellowbrick</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a55f234726f2ac5e06e3d0a92fec0f1d790e516cc9245f714facce8c4acea4d3.png" src="_images/a55f234726f2ac5e06e3d0a92fec0f1d790e516cc9245f714facce8c4acea4d3.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Distortion Score Elbow for KMeans Clustering&#39;}, xlabel=&#39;k&#39;, ylabel=&#39;distortion score&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c536d26d5a9de3ae6c639c46cb72e3ed5800068530d39adaaa0679e2c25935f5.png" src="_images/c536d26d5a9de3ae6c639c46cb72e3ed5800068530d39adaaa0679e2c25935f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">visualizer</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Distortion Score Elbow for KMeans Clustering&#39;}, xlabel=&#39;k&#39;, ylabel=&#39;distortion score&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="method-2-the-silhouette-method">
<h3>Method 2: The Silhouette method<a class="headerlink" href="#method-2-the-silhouette-method" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Not dependent on the notion of cluster centers.</p></li>
<li><p>Calculated using the <strong>mean intra-cluster distance</strong> (<span class="math notranslate nohighlight">\(a\)</span>) and the <strong>mean nearest-cluster distance</strong> (<span class="math notranslate nohighlight">\(b\)</span>) for each sample.</p></li>
</ul>
</section>
<section id="mean-intra-cluster-distance-a">
<h3>Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)<a class="headerlink" href="#mean-intra-cluster-distance-a" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Suppose the green point below is our sample.</p></li>
<li><p>Average of the distances of the green point to <strong>the other points in the same cluster</strong>.</p>
<ul>
<li><p>These distances are represented by the black lines.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_silhouette_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/294dd70be6c67b3688e6c9028c318ae4e51f351c5310a384cb287586ac6d040e.png" src="_images/294dd70be6c67b3688e6c9028c318ae4e51f351c5310a384cb287586ac6d040e.png" />
</div>
</div>
</section>
<section id="mean-nearest-cluster-distance-b">
<h3>Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)<a class="headerlink" href="#mean-nearest-cluster-distance-b" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The average of the distances from the green point to the blue points is smaller than the average of the distances from the green point to the red points. So the <strong>nearest cluster</strong> is the blue cluster.</p></li>
<li><p>So the mean nearest-cluster distance is the average of the distances from <strong>the green point to the blue points</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_silhouette_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/294dd70be6c67b3688e6c9028c318ae4e51f351c5310a384cb287586ac6d040e.png" src="_images/294dd70be6c67b3688e6c9028c318ae4e51f351c5310a384cb287586ac6d040e.png" />
</div>
</div>
</section>
<section id="silhouette-distance-for-a-sample">
<h3>Silhouette distance for a sample<a class="headerlink" href="#silhouette-distance-for-a-sample" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>the difference between <strong>the average nearest-cluster distance</strong> (<span class="math notranslate nohighlight">\(b\)</span>) and <strong>average intra-cluster distance</strong> (<span class="math notranslate nohighlight">\(a\)</span>) for each sample, normalized by the maximum value</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{b-a}{max(a,b)}\]</div>
<ul class="simple">
<li><p>The best value is 1.</p></li>
<li><p>The worst value is -1 (samples have been assigned to the wrong clusters).</p></li>
<li><p>The value near 0 means overlapping clusters.</p></li>
</ul>
<p>The overall <strong>Silhouette score</strong> is the average of the Silhouette scores for all samples.</p>
</section>
<section id="using-silhouette-scores-to-select-the-number-of-clusters">
<h3>Using Silhouette scores to select the number of clusters<a class="headerlink" href="#using-silhouette-scores-to-select-the-number-of-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The plots below show the Silhouette scores for each sample in that cluster.</p></li>
<li><p>Higher values indicate well-separated clusters.</p></li>
<li><p>The size of the Silhouette shows the number of samples and hence shows the imbalance of data points in clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ab97e80537dda5eb3a501b505c9b4936de4dc49426da8cbf42613fd5ea68dcbf.png" src="_images/ab97e80537dda5eb3a501b505c9b4936de4dc49426da8cbf42613fd5ea68dcbf.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 100 Samples in 2 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e6456f323fee6cdd604349f03d742b268d13fd58472e124e239e3786dc2df5b3.png" src="_images/e6456f323fee6cdd604349f03d742b268d13fd58472e124e239e3786dc2df5b3.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 100 Samples in 3 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b0982911064862ac098236c2bec222f047fcead6b1430a42f991f02f5f74568a.png" src="_images/b0982911064862ac098236c2bec222f047fcead6b1430a42f991f02f5f74568a.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 100 Samples in 5 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-to-look-for-in-these-plots">
<h3>What to look for in these plots?<a class="headerlink" href="#what-to-look-for-in-these-plots" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Unlike inertia, larger values are better because they indicate that the point is further away from neighboring clusters.</p></li>
<li><p>The thickness of each silhouette indicates the cluster size.</p></li>
<li><p>The shape of each silhouette indicates the “goodness” of points in each cluster.</p></li>
<li><p>The length (or area) of each silhouette indicates the goodness of each cluster.</p></li>
<li><p>A slower dropoff (more rectangular) indicates more points are “happy” in their cluster.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e6456f323fee6cdd604349f03d742b268d13fd58472e124e239e3786dc2df5b3.png" src="_images/e6456f323fee6cdd604349f03d742b268d13fd58472e124e239e3786dc2df5b3.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 100 Samples in 3 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="comments-on-silhouette-scores">
<h3>Comments on Silhouette scores<a class="headerlink" href="#comments-on-silhouette-scores" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Unlike inertia, larger values are better because they indicate that the point is further away from neighboring clusters.</p></li>
<li><p>Unlike inertia, the overall silhouette score gets worse as you add more clusters because you end up being closer to neighboring clusters.</p></li>
<li><p>Thus, as with inertia, you will not see a “peak” value of this metric that indicates the best number of clusters.</p></li>
<li><p>We can visualize the silhouette score for each example individually in a silhouette plot (hence the name), see below.</p></li>
<li><p>We can apply the Silhouette method to clustering methods other than K-Means.</p></li>
</ul>
</section>
<section id="k-means-true-false-questions">
<h3>K-Means: True/False questions<a class="headerlink" href="#k-means-true-false-questions" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The preprocessing methods such as scaling and imputation are unsupervised methods.</p></li>
<li><p>K-Means algorithm always converges to the same solution.</p></li>
<li><p><span class="math notranslate nohighlight">\(K\)</span> in K-Means should always be <span class="math notranslate nohighlight">\(\leq\)</span> # of features.</p></li>
<li><p>In K-Means, it makes sense to have <span class="math notranslate nohighlight">\(K\)</span> <span class="math notranslate nohighlight">\(\leq\)</span> # of examples.</p></li>
</ul>
</section>
<section id="id7">
<h3>K-Means: True/False questions<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In some iterations, some points may be left unassigned.</p></li>
<li><p>K-Means is sensitive to initialization and the solution may change depending upon the initialization.</p></li>
<li><p>K-means terminates when the number of clusters does not increase between iterations.</p></li>
<li><p>K-means terminates when the centroid locations do not change between iterations.</p></li>
</ul>
</section>
</section>
<section id="k-means-case-study-customer-segmentation">
<h2>K-Means case study: Customer segmentation<a class="headerlink" href="#k-means-case-study-customer-segmentation" title="Permalink to this heading">#</a></h2>
<section id="what-is-customer-segmentation">
<h3>What is customer segmentation?<a class="headerlink" href="#what-is-customer-segmentation" title="Permalink to this heading">#</a></h3>
<p>Check out <a class="reference external" href="https://www.ted.com/talks/malcolm_gladwell_on_spaghetti_sauce?language=en">this interesting talk by Malcolm Gladwell</a>. Humans are diverse and there is no single spaghetti sauce that would make all of them happy!</p>
<p>Often it’s beneficial to businesses to explore the landscape of the market and tailor their services and products offered to each group. This is called <strong>customer segmentation</strong>. It’s usually applied when the dataset contains some of the following features.</p>
<ul class="simple">
<li><p><strong>Demographic information</strong> such as gender, age, marital status, income, education, and occupation</p></li>
<li><p><strong>Geographical information</strong> such as specific towns or counties or a customer’s city, state, or even country of residence (in the case of big global companies)</p></li>
<li><p><strong>Psychographics</strong> such as social class, lifestyle, and personality traits</p></li>
<li><p><strong>Behavioral data</strong> such as spending and consumption habits, product/service usage, and desired benefits</p></li>
</ul>
</section>
<section id="business-problem">
<h3>Business problem<a class="headerlink" href="#business-problem" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Imagine that you are hired as a data scientist at a bank. They provide some data of their credit card customers to you.</p></li>
<li><p>Their goal is to develop customized marketing campaigns and they ask you to group customers based on the given information.</p></li>
<li><p>Now that you know about K-Means clustering, let’s apply it to the dataset to group customers.</p></li>
</ul>
</section>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>We will use the <a class="reference external" href="https://www.kaggle.com/arjunbhasin2013/ccdata">Credit Card Dataset for clustering</a> from Kaggle.</p></li>
<li><p>Download the data and save the CSV under the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder.</p></li>
<li><p>I encourage you to work through this case study on your own.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;data/cc-general.csv&quot;</span><span class="p">)</span>
<span class="n">creditcard_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cc-general.csv&quot;</span><span class="p">)</span>
<span class="n">creditcard_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8950, 18)
</pre></div>
</div>
</div>
</div>
</section>
<section id="information-on-the-dataset">
<h3>Information on the dataset<a class="headerlink" href="#information-on-the-dataset" title="Permalink to this heading">#</a></h3>
<p>We have behavioral data.</p>
<ul class="simple">
<li><p>CUSTID: Identification of Credit Card holder</p></li>
<li><p>BALANCE: Balance amount left in customer’s account to make purchases</p></li>
<li><p>BALANCE_FREQUENCY: How frequently the Balance is updated, a score between 0 and 1 (1 = frequently updated, 0 = not frequently updated)</p></li>
<li><p>PURCHASES: Amount of purchases made from an account</p></li>
<li><p>ONEOFFPURCHASES: Maximum purchase amount done in one go</p></li>
<li><p>INSTALLMENTS_PURCHASES: Amount of purchase done in installment</p></li>
<li><p>CASH_ADVANCE: Cash in advance given by the user</p></li>
<li><p>PURCHASES_FREQUENCY: How frequently the Purchases are being made, a score between 0 and 1 (1 = frequently purchased, 0 = not frequently purchased)</p></li>
<li><p>ONEOFF_PURCHASES_FREQUENCY: How frequently Purchases are happening in one go (1 = frequently purchased, 0 = not frequently purchased)</p></li>
<li><p>PURCHASES_INSTALLMENTS_FREQUENCY: How frequently purchases in installments are being done (1 = frequently done, 0 = not frequently done)</p></li>
<li><p>CASH_ADVANCE_FREQUENCY: How frequently the cash in advance is being paid</p></li>
<li><p>CASH_ADVANCE_TRX: Number of Transactions made with “Cash in Advance”</p></li>
<li><p>PURCHASES_TRX: Number of purchase transactions made</p></li>
<li><p>CREDIT_LIMIT: Limit of Credit Card for users</p></li>
<li><p>PAYMENTS: Amount of Payment done by users</p></li>
<li><p>MINIMUM_PAYMENTS: Minimum amount of payments made by user</p></li>
<li><p>PRC_FULL_PAYMENT: Percent of full payment paid by user</p></li>
<li><p>TENURE: Tenure of credit card service for user</p></li>
</ul>
</section>
<section id="preliminary-eda">
<h3>Preliminary EDA<a class="headerlink" href="#preliminary-eda" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creditcard_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8950 entries, 0 to 8949
Data columns (total 18 columns):
 #   Column                            Non-Null Count  Dtype  
---  ------                            --------------  -----  
 0   CUST_ID                           8950 non-null   object 
 1   BALANCE                           8950 non-null   float64
 2   BALANCE_FREQUENCY                 8950 non-null   float64
 3   PURCHASES                         8950 non-null   float64
 4   ONEOFF_PURCHASES                  8950 non-null   float64
 5   INSTALLMENTS_PURCHASES            8950 non-null   float64
 6   CASH_ADVANCE                      8950 non-null   float64
 7   PURCHASES_FREQUENCY               8950 non-null   float64
 8   ONEOFF_PURCHASES_FREQUENCY        8950 non-null   float64
 9   PURCHASES_INSTALLMENTS_FREQUENCY  8950 non-null   float64
 10  CASH_ADVANCE_FREQUENCY            8950 non-null   float64
 11  CASH_ADVANCE_TRX                  8950 non-null   int64  
 12  PURCHASES_TRX                     8950 non-null   int64  
 13  CREDIT_LIMIT                      8949 non-null   float64
 14  PAYMENTS                          8950 non-null   float64
 15  MINIMUM_PAYMENTS                  8637 non-null   float64
 16  PRC_FULL_PAYMENT                  8950 non-null   float64
 17  TENURE                            8950 non-null   int64  
dtypes: float64(14), int64(3), object(1)
memory usage: 1.2+ MB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>All numeric features</p></li>
<li><p>Some missing values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creditcard_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>PURCHASES</th>
      <th>ONEOFF_PURCHASES</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>CASH_ADVANCE</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>PURCHASES_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>PAYMENTS</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
      <td>8949.000000</td>
      <td>8950.000000</td>
      <td>8637.000000</td>
      <td>8950.000000</td>
      <td>8950.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1564.474828</td>
      <td>0.877271</td>
      <td>1003.204834</td>
      <td>592.437371</td>
      <td>411.067645</td>
      <td>978.871112</td>
      <td>0.490351</td>
      <td>0.202458</td>
      <td>0.364437</td>
      <td>0.135144</td>
      <td>3.248827</td>
      <td>14.709832</td>
      <td>4494.449450</td>
      <td>1733.143852</td>
      <td>864.206542</td>
      <td>0.153715</td>
      <td>11.517318</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2081.531879</td>
      <td>0.236904</td>
      <td>2136.634782</td>
      <td>1659.887917</td>
      <td>904.338115</td>
      <td>2097.163877</td>
      <td>0.401371</td>
      <td>0.298336</td>
      <td>0.397448</td>
      <td>0.200121</td>
      <td>6.824647</td>
      <td>24.857649</td>
      <td>3638.815725</td>
      <td>2895.063757</td>
      <td>2372.446607</td>
      <td>0.292499</td>
      <td>1.338331</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>50.000000</td>
      <td>0.000000</td>
      <td>0.019163</td>
      <td>0.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>128.281915</td>
      <td>0.888889</td>
      <td>39.635000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.083333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1600.000000</td>
      <td>383.276166</td>
      <td>169.123707</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>873.385231</td>
      <td>1.000000</td>
      <td>361.280000</td>
      <td>38.000000</td>
      <td>89.000000</td>
      <td>0.000000</td>
      <td>0.500000</td>
      <td>0.083333</td>
      <td>0.166667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.000000</td>
      <td>3000.000000</td>
      <td>856.901546</td>
      <td>312.343947</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2054.140036</td>
      <td>1.000000</td>
      <td>1110.130000</td>
      <td>577.405000</td>
      <td>468.637500</td>
      <td>1113.821139</td>
      <td>0.916667</td>
      <td>0.300000</td>
      <td>0.750000</td>
      <td>0.222222</td>
      <td>4.000000</td>
      <td>17.000000</td>
      <td>6500.000000</td>
      <td>1901.134317</td>
      <td>825.485459</td>
      <td>0.142857</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>19043.138560</td>
      <td>1.000000</td>
      <td>49039.570000</td>
      <td>40761.250000</td>
      <td>22500.000000</td>
      <td>47137.211760</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.500000</td>
      <td>123.000000</td>
      <td>358.000000</td>
      <td>30000.000000</td>
      <td>50721.483360</td>
      <td>76406.207520</td>
      <td>1.000000</td>
      <td>12.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="practice-exercises-for-you">
<h3>Practice exercises for you<a class="headerlink" href="#practice-exercises-for-you" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>What is the average <code class="docutils literal notranslate"><span class="pre">BALANCE</span></code> amount?</p></li>
<li><p>How often the <code class="docutils literal notranslate"><span class="pre">BALANCE_FREQUENCY</span></code> is updated on average?</p></li>
<li><p>Obtain the row of the customer who made the maximum cash advance transaction.</p></li>
</ol>
</section>
<section id="mini-exercises-for-you-answers">
<h3>Mini exercises for you (Answers)<a class="headerlink" href="#mini-exercises-for-you-answers" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>What is the average <code class="docutils literal notranslate"><span class="pre">BALANCE</span></code> amount? 1564.47</p></li>
<li><p>How often the <code class="docutils literal notranslate"><span class="pre">BALANCE_FREQUENCY</span></code> is updated on average? 0.88 (pretty often)</p></li>
<li><p>Obtain the row of the customer who made the maximum cash advance transaction.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_cash_advance</span> <span class="o">=</span> <span class="n">creditcard_df</span><span class="p">[</span><span class="s2">&quot;CASH_ADVANCE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">creditcard_df</span><span class="p">[</span><span class="n">creditcard_df</span><span class="p">[</span><span class="s2">&quot;CASH_ADVANCE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_cash_advance</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CUST_ID</th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>PURCHASES</th>
      <th>ONEOFF_PURCHASES</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>CASH_ADVANCE</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>PURCHASES_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>PAYMENTS</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2159</th>
      <td>C12226</td>
      <td>10905.05381</td>
      <td>1.0</td>
      <td>431.93</td>
      <td>133.5</td>
      <td>298.43</td>
      <td>47137.21176</td>
      <td>0.583333</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>1.0</td>
      <td>123</td>
      <td>21</td>
      <td>19600.0</td>
      <td>39048.59762</td>
      <td>5394.173671</td>
      <td>0.0</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s examine correlations between features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cor</span> <span class="o">=</span> <span class="n">creditcard_df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cor</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: &gt;
</pre></div>
</div>
<img alt="_images/d03958f1c5bec51e28889a2f229deeab27b08f16d0d197036aaf999abf5a214e.png" src="_images/d03958f1c5bec51e28889a2f229deeab27b08f16d0d197036aaf999abf5a214e.png" />
</div>
</div>
</section>
<section id="feature-types-and-preprocessing">
<h3>Feature types and preprocessing<a class="headerlink" href="#feature-types-and-preprocessing" title="Permalink to this heading">#</a></h3>
<p>Let’s identify different feature types and transformations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creditcard_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;CUST_ID&#39;, &#39;BALANCE&#39;, &#39;BALANCE_FREQUENCY&#39;, &#39;PURCHASES&#39;,
       &#39;ONEOFF_PURCHASES&#39;, &#39;INSTALLMENTS_PURCHASES&#39;, &#39;CASH_ADVANCE&#39;,
       &#39;PURCHASES_FREQUENCY&#39;, &#39;ONEOFF_PURCHASES_FREQUENCY&#39;,
       &#39;PURCHASES_INSTALLMENTS_FREQUENCY&#39;, &#39;CASH_ADVANCE_FREQUENCY&#39;,
       &#39;CASH_ADVANCE_TRX&#39;, &#39;PURCHASES_TRX&#39;, &#39;CREDIT_LIMIT&#39;, &#39;PAYMENTS&#39;,
       &#39;MINIMUM_PAYMENTS&#39;, &#39;PRC_FULL_PAYMENT&#39;, &#39;TENURE&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drop_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CUST_ID&quot;</span><span class="p">]</span>
<span class="n">numeric_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">creditcard_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">drop_features</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">SimpleImputer</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">())</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">make_column_transformer</span><span class="p">(</span>
    <span class="p">(</span><span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="n">drop_features</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transformed_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
    <span class="n">creditcard_df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">numeric_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transformed_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASH_ADVANCE</th>
      <th>CREDIT_LIMIT</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>ONEOFF_PURCHASES</th>
      <th>BALANCE</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>BALANCE_FREQUENCY</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>PAYMENTS</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.466786</td>
      <td>-0.960433</td>
      <td>-3.109675e-01</td>
      <td>-0.525551</td>
      <td>-0.707313</td>
      <td>-0.356934</td>
      <td>-0.731989</td>
      <td>-0.476070</td>
      <td>-0.249434</td>
      <td>-0.806490</td>
      <td>-0.675349</td>
      <td>-0.511333</td>
      <td>-0.424900</td>
      <td>-0.678661</td>
      <td>-0.349079</td>
      <td>-0.528979</td>
      <td>0.360680</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.605605</td>
      <td>0.688639</td>
      <td>8.931021e-02</td>
      <td>0.234227</td>
      <td>-0.916995</td>
      <td>-0.356934</td>
      <td>0.786961</td>
      <td>0.110074</td>
      <td>0.134325</td>
      <td>-1.221758</td>
      <td>0.573963</td>
      <td>-0.591796</td>
      <td>-0.469552</td>
      <td>-0.678661</td>
      <td>-0.454576</td>
      <td>0.818642</td>
      <td>0.360680</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.466786</td>
      <td>0.826062</td>
      <td>-1.016632e-01</td>
      <td>-0.525551</td>
      <td>-0.916995</td>
      <td>0.108889</td>
      <td>0.447135</td>
      <td>-0.476070</td>
      <td>0.518084</td>
      <td>1.269843</td>
      <td>-0.675349</td>
      <td>-0.109020</td>
      <td>-0.107668</td>
      <td>2.673451</td>
      <td>-0.454576</td>
      <td>-0.383805</td>
      <td>0.360680</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.368653</td>
      <td>0.826062</td>
      <td>4.878305e-17</td>
      <td>-0.525551</td>
      <td>-0.916995</td>
      <td>0.546189</td>
      <td>0.049099</td>
      <td>-0.329534</td>
      <td>-1.016953</td>
      <td>-1.014125</td>
      <td>-0.258913</td>
      <td>-0.551565</td>
      <td>0.232058</td>
      <td>-0.399319</td>
      <td>-0.454576</td>
      <td>-0.598688</td>
      <td>0.360680</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.466786</td>
      <td>-0.905464</td>
      <td>-2.657913e-01</td>
      <td>-0.525551</td>
      <td>-0.916995</td>
      <td>-0.347294</td>
      <td>-0.358775</td>
      <td>-0.476070</td>
      <td>0.518084</td>
      <td>-1.014125</td>
      <td>-0.675349</td>
      <td>-0.551565</td>
      <td>-0.462063</td>
      <td>-0.399319</td>
      <td>-0.454576</td>
      <td>-0.364368</td>
      <td>0.360680</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8945</th>
      <td>-0.466786</td>
      <td>-0.960433</td>
      <td>-3.498541e-01</td>
      <td>1.183951</td>
      <td>1.179833</td>
      <td>-0.356934</td>
      <td>-0.737950</td>
      <td>-0.476070</td>
      <td>0.518084</td>
      <td>1.269843</td>
      <td>-0.675349</td>
      <td>-0.350408</td>
      <td>-0.333293</td>
      <td>-0.678661</td>
      <td>-0.132643</td>
      <td>-0.486217</td>
      <td>-4.122768</td>
    </tr>
    <tr>
      <th>8946</th>
      <td>-0.466786</td>
      <td>-0.960433</td>
      <td>4.878305e-17</td>
      <td>-0.525551</td>
      <td>1.179833</td>
      <td>-0.356934</td>
      <td>-0.742423</td>
      <td>-0.476070</td>
      <td>0.518084</td>
      <td>1.269843</td>
      <td>-0.675349</td>
      <td>-0.350408</td>
      <td>-0.329136</td>
      <td>-0.678661</td>
      <td>-0.122823</td>
      <td>-0.503396</td>
      <td>-4.122768</td>
    </tr>
    <tr>
      <th>8947</th>
      <td>-0.466786</td>
      <td>-0.960433</td>
      <td>-3.354655e-01</td>
      <td>0.329200</td>
      <td>0.760469</td>
      <td>-0.356934</td>
      <td>-0.740398</td>
      <td>-0.476070</td>
      <td>-0.185477</td>
      <td>0.854576</td>
      <td>-0.675349</td>
      <td>-0.390639</td>
      <td>-0.401965</td>
      <td>-0.678661</td>
      <td>-0.294893</td>
      <td>-0.570615</td>
      <td>-4.122768</td>
    </tr>
    <tr>
      <th>8948</th>
      <td>-0.449352</td>
      <td>-1.097856</td>
      <td>-3.469065e-01</td>
      <td>0.329200</td>
      <td>-0.916995</td>
      <td>-0.356934</td>
      <td>-0.745174</td>
      <td>-0.182998</td>
      <td>-0.185477</td>
      <td>-1.221758</td>
      <td>0.157527</td>
      <td>-0.591796</td>
      <td>-0.469552</td>
      <td>-0.678661</td>
      <td>-0.454576</td>
      <td>-0.580536</td>
      <td>-4.122768</td>
    </tr>
    <tr>
      <th>8949</th>
      <td>-0.406205</td>
      <td>-0.905464</td>
      <td>-3.329464e-01</td>
      <td>-0.525551</td>
      <td>-0.916995</td>
      <td>0.301732</td>
      <td>-0.572575</td>
      <td>-0.182998</td>
      <td>-0.889033</td>
      <td>0.439310</td>
      <td>0.990398</td>
      <td>0.333524</td>
      <td>0.042146</td>
      <td>1.556082</td>
      <td>-0.454576</td>
      <td>-0.576869</td>
      <td>-4.122768</td>
    </tr>
  </tbody>
</table>
<p>8950 rows × 17 columns</p>
</div></div></div>
</div>
<p>Now that we have transformed the data, we are ready to run K-Means to cluster credit card customers.</p>
</section>
<section id="tuning-the-hyperparameter-n-clusters">
<h3>Tuning the hyperparameter <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code><a class="headerlink" href="#tuning-the-hyperparameter-n-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s first obtain the optimal number of clusters using the Elbow method.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e5b4aae938005bfa38c191f72a7fc4c3864fb3725b8dc0682eccc027fd4b3a49.png" src="_images/e5b4aae938005bfa38c191f72a7fc4c3864fb3725b8dc0682eccc027fd4b3a49.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Distortion Score Elbow for KMeans Clustering&#39;}, xlabel=&#39;k&#39;, ylabel=&#39;distortion score&#39;&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The optimal number of clusters is not as clear as it was in our toy example.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s examine Silhouette scores.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f4394e1768dcaebf41be97d01c0589db477dcc5507012786785068c302fbf913.png" src="_images/f4394e1768dcaebf41be97d01c0589db477dcc5507012786785068c302fbf913.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 8950 Samples in 4 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a44675b4f2277674b1ea258e31b83915cc036b37081903ce2d23224260d02d92.png" src="_images/a44675b4f2277674b1ea258e31b83915cc036b37081903ce2d23224260d02d92.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 8950 Samples in 5 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/73d9cd91aedacd48cef2a1eb9662d0b0add8b8163d1b3b848662e744b499a879.png" src="_images/73d9cd91aedacd48cef2a1eb9662d0b0add8b8163d1b3b848662e744b499a879.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: title={&#39;center&#39;: &#39;Silhouette Plot of KMeans Clustering for 8950 Samples in 6 Centers&#39;}, xlabel=&#39;silhouette coefficient values&#39;, ylabel=&#39;cluster label&#39;&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>I’m going to run <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> with <code class="docutils literal notranslate"><span class="pre">n_clusters</span> <span class="pre">=</span> <span class="pre">4</span></code>.</p></li>
<li><p>You can try out <code class="docutils literal notranslate"><span class="pre">n_clusters</span> <span class="pre">=</span> <span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">n_clusters</span> <span class="pre">=</span> <span class="pre">6</span></code> on your own.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 17)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Let’s visualize the clusters in two dimensions using PCA, which is a popular dimensionality reduction technique.</p></li>
<li><p>We won’t be talking about PCA in this course but I’ll be using it for visualization.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain the principal components</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>


<span class="k">def</span> <span class="nf">plot_pca_clusters</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Carries out dimensionality reduction on the data for visualization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">principal_comp</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">pca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">principal_comp</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                          <span class="s2">&quot;pca1&quot;</span><span class="p">,</span> <span class="s2">&quot;pca2&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">pca_df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;pca1&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pca2&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span>
                         <span class="n">data</span><span class="o">=</span><span class="n">pca_df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_pca_clusters</span><span class="p">(</span><span class="n">transformed_df</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/abe10080c5684aeeb670df6cf881858fa07b991a1412af2e214f364b5f06c26f.png" src="_images/abe10080c5684aeeb670df6cf881858fa07b991a1412af2e214f364b5f06c26f.png" />
</div>
</div>
<ul class="simple">
<li><p>The clusters above look reasonably well separated.</p></li>
<li><p>This might not always be the case.</p></li>
</ul>
</section>
<section id="cluster-interpretation">
<h3>Cluster interpretation<a class="headerlink" href="#cluster-interpretation" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s examine the cluster centers and identify types of customers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                               <span class="n">transformed_df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
<span class="n">cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>CASH_ADVANCE</th>
      <th>CREDIT_LIMIT</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>ONEOFF_PURCHASES</th>
      <th>BALANCE</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>BALANCE_FREQUENCY</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>PAYMENTS</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.155091</td>
      <td>1.429882</td>
      <td>0.477421</td>
      <td>0.454703</td>
      <td>1.065918</td>
      <td>2.713251</td>
      <td>0.954485</td>
      <td>-0.170458</td>
      <td>0.462694</td>
      <td>1.136338</td>
      <td>-0.319096</td>
      <td>3.003251</td>
      <td>3.125845</td>
      <td>1.798653</td>
      <td>2.406470</td>
      <td>1.919096</td>
      <td>0.324140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.688972</td>
      <td>0.838968</td>
      <td>0.490910</td>
      <td>-0.406367</td>
      <td>-0.450201</td>
      <td>-0.163914</td>
      <td>1.459578</td>
      <td>1.617143</td>
      <td>0.384753</td>
      <td>-0.504848</td>
      <td>1.745948</td>
      <td>-0.283580</td>
      <td>-0.234638</td>
      <td>-0.212939</td>
      <td>-0.253747</td>
      <td>0.603821</td>
      <td>-0.097146</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.182691</td>
      <td>-0.334417</td>
      <td>-0.119249</td>
      <td>-0.258866</td>
      <td>-0.714246</td>
      <td>-0.230500</td>
      <td>-0.265552</td>
      <td>-0.164607</td>
      <td>-0.368944</td>
      <td>-0.797823</td>
      <td>-0.101500</td>
      <td>-0.474987</td>
      <td>-0.343190</td>
      <td>-0.389437</td>
      <td>-0.387798</td>
      <td>-0.262060</td>
      <td>-0.052972</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.366373</td>
      <td>-0.077298</td>
      <td>-0.091844</td>
      <td>0.395041</td>
      <td>0.874138</td>
      <td>0.000926</td>
      <td>-0.321688</td>
      <td>-0.360303</td>
      <td>0.242574</td>
      <td>0.983721</td>
      <td>-0.462599</td>
      <td>0.296985</td>
      <td>0.109044</td>
      <td>0.317153</td>
      <td>0.255904</td>
      <td>-0.138502</td>
      <td>0.057744</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Recall that we have applied imputation and scaling on the dataset.</p></li>
<li><p>But, we would be able to interpret these clusters better if the centers were in the original scale.</p></li>
<li><p>So let’s apply inverse transformations to get the cluster center values in the original scale.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">preprocessor</span><span class="o">.</span><span class="n">named_transformers_</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;standardscaler&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">cluster_centers</span><span class="p">[</span><span class="n">numeric_features</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">org_cluster_centers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">numeric_features</span><span class="p">)</span>
<span class="n">org_cluster_centers</span> <span class="o">=</span> <span class="n">org_cluster_centers</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
    <span class="nb">sorted</span><span class="p">(</span><span class="n">org_cluster_centers</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">org_cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>CASH_ADVANCE</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>ONEOFF_PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3551.153761</td>
      <td>0.986879</td>
      <td>653.638891</td>
      <td>0.071290</td>
      <td>2.085575</td>
      <td>9696.943765</td>
      <td>2587.208264</td>
      <td>1976.815179</td>
      <td>5095.878826</td>
      <td>0.739031</td>
      <td>7288.739497</td>
      <td>0.286707</td>
      <td>7681.620098</td>
      <td>0.946418</td>
      <td>0.788060</td>
      <td>89.359413</td>
      <td>11.951100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4602.462714</td>
      <td>0.968415</td>
      <td>4520.724309</td>
      <td>0.484526</td>
      <td>14.284641</td>
      <td>7546.957050</td>
      <td>181.607404</td>
      <td>2008.251157</td>
      <td>320.373681</td>
      <td>0.138934</td>
      <td>3481.145990</td>
      <td>0.034859</td>
      <td>501.896219</td>
      <td>0.287731</td>
      <td>0.185516</td>
      <td>7.661102</td>
      <td>11.387312</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1011.751528</td>
      <td>0.789871</td>
      <td>595.759339</td>
      <td>0.114833</td>
      <td>2.125503</td>
      <td>3277.703165</td>
      <td>60.386625</td>
      <td>586.301239</td>
      <td>209.853863</td>
      <td>0.086281</td>
      <td>974.505090</td>
      <td>0.078001</td>
      <td>269.973466</td>
      <td>0.170146</td>
      <td>0.080578</td>
      <td>2.903421</td>
      <td>11.446429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>894.907458</td>
      <td>0.934734</td>
      <td>210.570626</td>
      <td>0.042573</td>
      <td>0.790021</td>
      <td>4213.207678</td>
      <td>642.478274</td>
      <td>650.167072</td>
      <td>593.974874</td>
      <td>0.297070</td>
      <td>1332.194205</td>
      <td>0.269258</td>
      <td>1236.178934</td>
      <td>0.885165</td>
      <td>0.711842</td>
      <td>22.091773</td>
      <td>11.594595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">org_cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>CASH_ADVANCE</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>ONEOFF_PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3551.153761</td>
      <td>0.986879</td>
      <td>653.638891</td>
      <td>0.071290</td>
      <td>2.085575</td>
      <td>9696.943765</td>
      <td>2587.208264</td>
      <td>1976.815179</td>
      <td>5095.878826</td>
      <td>0.739031</td>
      <td>7288.739497</td>
      <td>0.286707</td>
      <td>7681.620098</td>
      <td>0.946418</td>
      <td>0.788060</td>
      <td>89.359413</td>
      <td>11.951100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4602.462714</td>
      <td>0.968415</td>
      <td>4520.724309</td>
      <td>0.484526</td>
      <td>14.284641</td>
      <td>7546.957050</td>
      <td>181.607404</td>
      <td>2008.251157</td>
      <td>320.373681</td>
      <td>0.138934</td>
      <td>3481.145990</td>
      <td>0.034859</td>
      <td>501.896219</td>
      <td>0.287731</td>
      <td>0.185516</td>
      <td>7.661102</td>
      <td>11.387312</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1011.751528</td>
      <td>0.789871</td>
      <td>595.759339</td>
      <td>0.114833</td>
      <td>2.125503</td>
      <td>3277.703165</td>
      <td>60.386625</td>
      <td>586.301239</td>
      <td>209.853863</td>
      <td>0.086281</td>
      <td>974.505090</td>
      <td>0.078001</td>
      <td>269.973466</td>
      <td>0.170146</td>
      <td>0.080578</td>
      <td>2.903421</td>
      <td>11.446429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>894.907458</td>
      <td>0.934734</td>
      <td>210.570626</td>
      <td>0.042573</td>
      <td>0.790021</td>
      <td>4213.207678</td>
      <td>642.478274</td>
      <td>650.167072</td>
      <td>593.974874</td>
      <td>0.297070</td>
      <td>1332.194205</td>
      <td>0.269258</td>
      <td>1236.178934</td>
      <td>0.885165</td>
      <td>0.711842</td>
      <td>22.091773</td>
      <td>11.594595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="transactors">
<h4>Transactors<a class="headerlink" href="#transactors" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Credit card users who pay off their balance every month with the least amount of interest charges.</p></li>
<li><p>They are careful with their money.</p></li>
<li><p>They have the lowest balance and cash advance</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">org_cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>CASH_ADVANCE</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>ONEOFF_PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3551.153761</td>
      <td>0.986879</td>
      <td>653.638891</td>
      <td>0.071290</td>
      <td>2.085575</td>
      <td>9696.943765</td>
      <td>2587.208264</td>
      <td>1976.815179</td>
      <td>5095.878826</td>
      <td>0.739031</td>
      <td>7288.739497</td>
      <td>0.286707</td>
      <td>7681.620098</td>
      <td>0.946418</td>
      <td>0.788060</td>
      <td>89.359413</td>
      <td>11.951100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4602.462714</td>
      <td>0.968415</td>
      <td>4520.724309</td>
      <td>0.484526</td>
      <td>14.284641</td>
      <td>7546.957050</td>
      <td>181.607404</td>
      <td>2008.251157</td>
      <td>320.373681</td>
      <td>0.138934</td>
      <td>3481.145990</td>
      <td>0.034859</td>
      <td>501.896219</td>
      <td>0.287731</td>
      <td>0.185516</td>
      <td>7.661102</td>
      <td>11.387312</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1011.751528</td>
      <td>0.789871</td>
      <td>595.759339</td>
      <td>0.114833</td>
      <td>2.125503</td>
      <td>3277.703165</td>
      <td>60.386625</td>
      <td>586.301239</td>
      <td>209.853863</td>
      <td>0.086281</td>
      <td>974.505090</td>
      <td>0.078001</td>
      <td>269.973466</td>
      <td>0.170146</td>
      <td>0.080578</td>
      <td>2.903421</td>
      <td>11.446429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>894.907458</td>
      <td>0.934734</td>
      <td>210.570626</td>
      <td>0.042573</td>
      <td>0.790021</td>
      <td>4213.207678</td>
      <td>642.478274</td>
      <td>650.167072</td>
      <td>593.974874</td>
      <td>0.297070</td>
      <td>1332.194205</td>
      <td>0.269258</td>
      <td>1236.178934</td>
      <td>0.885165</td>
      <td>0.711842</td>
      <td>22.091773</td>
      <td>11.594595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="revolvers">
<h4>Revolvers<a class="headerlink" href="#revolvers" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Credit card users who pay off only part of their monthly balance. They use credit cards as a loan.</p></li>
<li><p>They have the highest balance and cash advance, high cash advance frequency, low purchase frequency, high cash advance transactions, low percentage of full payment</p></li>
<li><p>Their credit limit is also high. (Lucrative group for banks.)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">org_cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>CASH_ADVANCE</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>ONEOFF_PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3551.153761</td>
      <td>0.986879</td>
      <td>653.638891</td>
      <td>0.071290</td>
      <td>2.085575</td>
      <td>9696.943765</td>
      <td>2587.208264</td>
      <td>1976.815179</td>
      <td>5095.878826</td>
      <td>0.739031</td>
      <td>7288.739497</td>
      <td>0.286707</td>
      <td>7681.620098</td>
      <td>0.946418</td>
      <td>0.788060</td>
      <td>89.359413</td>
      <td>11.951100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4602.462714</td>
      <td>0.968415</td>
      <td>4520.724309</td>
      <td>0.484526</td>
      <td>14.284641</td>
      <td>7546.957050</td>
      <td>181.607404</td>
      <td>2008.251157</td>
      <td>320.373681</td>
      <td>0.138934</td>
      <td>3481.145990</td>
      <td>0.034859</td>
      <td>501.896219</td>
      <td>0.287731</td>
      <td>0.185516</td>
      <td>7.661102</td>
      <td>11.387312</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1011.751528</td>
      <td>0.789871</td>
      <td>595.759339</td>
      <td>0.114833</td>
      <td>2.125503</td>
      <td>3277.703165</td>
      <td>60.386625</td>
      <td>586.301239</td>
      <td>209.853863</td>
      <td>0.086281</td>
      <td>974.505090</td>
      <td>0.078001</td>
      <td>269.973466</td>
      <td>0.170146</td>
      <td>0.080578</td>
      <td>2.903421</td>
      <td>11.446429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>894.907458</td>
      <td>0.934734</td>
      <td>210.570626</td>
      <td>0.042573</td>
      <td>0.790021</td>
      <td>4213.207678</td>
      <td>642.478274</td>
      <td>650.167072</td>
      <td>593.974874</td>
      <td>0.297070</td>
      <td>1332.194205</td>
      <td>0.269258</td>
      <td>1236.178934</td>
      <td>0.885165</td>
      <td>0.711842</td>
      <td>22.091773</td>
      <td>11.594595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="vip-prime">
<h4>VIP/Prime<a class="headerlink" href="#vip-prime" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Credit card users who have high credit limits.</p></li>
<li><p>They have high one-off purchase frequency and a high number of purchase transactions.</p></li>
<li><p>They have high balance but they also have a relatively higher percentage of full payment, similar to transactors</p></li>
<li><p>Target for increase credit limit (and increase spending habits )</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">org_cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>CASH_ADVANCE</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>ONEOFF_PURCHASES</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>PURCHASES</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>PURCHASES_TRX</th>
      <th>TENURE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3551.153761</td>
      <td>0.986879</td>
      <td>653.638891</td>
      <td>0.071290</td>
      <td>2.085575</td>
      <td>9696.943765</td>
      <td>2587.208264</td>
      <td>1976.815179</td>
      <td>5095.878826</td>
      <td>0.739031</td>
      <td>7288.739497</td>
      <td>0.286707</td>
      <td>7681.620098</td>
      <td>0.946418</td>
      <td>0.788060</td>
      <td>89.359413</td>
      <td>11.951100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4602.462714</td>
      <td>0.968415</td>
      <td>4520.724309</td>
      <td>0.484526</td>
      <td>14.284641</td>
      <td>7546.957050</td>
      <td>181.607404</td>
      <td>2008.251157</td>
      <td>320.373681</td>
      <td>0.138934</td>
      <td>3481.145990</td>
      <td>0.034859</td>
      <td>501.896219</td>
      <td>0.287731</td>
      <td>0.185516</td>
      <td>7.661102</td>
      <td>11.387312</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1011.751528</td>
      <td>0.789871</td>
      <td>595.759339</td>
      <td>0.114833</td>
      <td>2.125503</td>
      <td>3277.703165</td>
      <td>60.386625</td>
      <td>586.301239</td>
      <td>209.853863</td>
      <td>0.086281</td>
      <td>974.505090</td>
      <td>0.078001</td>
      <td>269.973466</td>
      <td>0.170146</td>
      <td>0.080578</td>
      <td>2.903421</td>
      <td>11.446429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>894.907458</td>
      <td>0.934734</td>
      <td>210.570626</td>
      <td>0.042573</td>
      <td>0.790021</td>
      <td>4213.207678</td>
      <td>642.478274</td>
      <td>650.167072</td>
      <td>593.974874</td>
      <td>0.297070</td>
      <td>1332.194205</td>
      <td>0.269258</td>
      <td>1236.178934</td>
      <td>0.885165</td>
      <td>0.711842</td>
      <td>22.091773</td>
      <td>11.594595</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="low-activity">
<h4>Low activity<a class="headerlink" href="#low-activity" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Credit card users who have low tenure and low credit limit.</p></li>
<li><p>There is not much activity in the account. It has a low balance and not many purchases.</p></li>
</ul>
</section>
</section>
<section id="more-on-the-interpretation-of-clusters">
<h3>More on the interpretation of clusters<a class="headerlink" href="#more-on-the-interpretation-of-clusters" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>In real life, you’ll look through all features in detail before assigning meaning to clusters.</p></li>
<li><p>This is not always easy, especially when you have a large number of features and clusters.</p></li>
<li><p>One way to approach this would be visualizing the distribution of feature values for each cluster as shown below.</p></li>
<li><p>Some domain knowledge would definitely help at this stage.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># concatenate the cluster labels to our original dataframe</span>
<span class="n">creditcard_df_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">creditcard_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;cluster&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">})],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">creditcard_df_cluster</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CUST_ID</th>
      <th>BALANCE</th>
      <th>BALANCE_FREQUENCY</th>
      <th>PURCHASES</th>
      <th>ONEOFF_PURCHASES</th>
      <th>INSTALLMENTS_PURCHASES</th>
      <th>CASH_ADVANCE</th>
      <th>PURCHASES_FREQUENCY</th>
      <th>ONEOFF_PURCHASES_FREQUENCY</th>
      <th>PURCHASES_INSTALLMENTS_FREQUENCY</th>
      <th>CASH_ADVANCE_FREQUENCY</th>
      <th>CASH_ADVANCE_TRX</th>
      <th>PURCHASES_TRX</th>
      <th>CREDIT_LIMIT</th>
      <th>PAYMENTS</th>
      <th>MINIMUM_PAYMENTS</th>
      <th>PRC_FULL_PAYMENT</th>
      <th>TENURE</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C10001</td>
      <td>40.900749</td>
      <td>0.818182</td>
      <td>95.40</td>
      <td>0.00</td>
      <td>95.4</td>
      <td>0.000000</td>
      <td>0.166667</td>
      <td>0.000000</td>
      <td>0.083333</td>
      <td>0.000000</td>
      <td>0</td>
      <td>2</td>
      <td>1000.0</td>
      <td>201.802084</td>
      <td>139.509787</td>
      <td>0.000000</td>
      <td>12</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C10002</td>
      <td>3202.467416</td>
      <td>0.909091</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6442.945483</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.250000</td>
      <td>4</td>
      <td>0</td>
      <td>7000.0</td>
      <td>4103.032597</td>
      <td>1072.340217</td>
      <td>0.222222</td>
      <td>12</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C10003</td>
      <td>2495.148862</td>
      <td>1.000000</td>
      <td>773.17</td>
      <td>773.17</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>12</td>
      <td>7500.0</td>
      <td>622.066742</td>
      <td>627.284787</td>
      <td>0.000000</td>
      <td>12</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C10004</td>
      <td>1666.670542</td>
      <td>0.636364</td>
      <td>1499.00</td>
      <td>1499.00</td>
      <td>0.0</td>
      <td>205.788017</td>
      <td>0.083333</td>
      <td>0.083333</td>
      <td>0.000000</td>
      <td>0.083333</td>
      <td>1</td>
      <td>1</td>
      <td>7500.0</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>12</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C10005</td>
      <td>817.714335</td>
      <td>1.000000</td>
      <td>16.00</td>
      <td>16.00</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.083333</td>
      <td>0.083333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>1</td>
      <td>1200.0</td>
      <td>678.334763</td>
      <td>244.791237</td>
      <td>0.000000</td>
      <td>12</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creditcard_df_cluster</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 1, 3, 0], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creditcard_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(18,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the histogram of various clusters</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">transformed_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">creditcard_df_cluster</span><span class="p">[</span><span class="n">creditcard_df_cluster</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">cluster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">    </span><span class="se">\n</span><span class="s2">Cluster </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15f8581b0f25b74b17623501cad496aef09e7cef141166984bbe08e8b1b9abf3.png" src="_images/15f8581b0f25b74b17623501cad496aef09e7cef141166984bbe08e8b1b9abf3.png" />
<img alt="_images/2658820055b19e185ed06f3288546feb5ecd0287cb2752582cc78d53dd75c173.png" src="_images/2658820055b19e185ed06f3288546feb5ecd0287cb2752582cc78d53dd75c173.png" />
<img alt="_images/93f3c25a3c39c400de43111be0c24633b098675d4843e47fca8e526a504557f3.png" src="_images/93f3c25a3c39c400de43111be0c24633b098675d4843e47fca8e526a504557f3.png" />
<img alt="_images/f92011bb14b03d4ad3110fad5ac5f5fd42e249cfd91a85efa16341c323f822df.png" src="_images/f92011bb14b03d4ad3110fad5ac5f5fd42e249cfd91a85efa16341c323f822df.png" />
<img alt="_images/6fbc4cbf9fe570de652e15747ed60e99afdfe1997d9cc1fdb821a152efe0365d.png" src="_images/6fbc4cbf9fe570de652e15747ed60e99afdfe1997d9cc1fdb821a152efe0365d.png" />
<img alt="_images/4be71d329a87702853eaf139576e0db18b20573fa63966d4c8340c202e1179ed.png" src="_images/4be71d329a87702853eaf139576e0db18b20573fa63966d4c8340c202e1179ed.png" />
<img alt="_images/24defe9f95c531c18bd7c27b69f17c2f265ba887a13844c8fcf5b3b68972bc85.png" src="_images/24defe9f95c531c18bd7c27b69f17c2f265ba887a13844c8fcf5b3b68972bc85.png" />
<img alt="_images/e7de0150e14b7eaa890db0cafd3ae2c419249cb747e664f9ce38ba9619647a46.png" src="_images/e7de0150e14b7eaa890db0cafd3ae2c419249cb747e664f9ce38ba9619647a46.png" />
<img alt="_images/dfc33c02a9666db56e0e4777b805a202ac88503a5f8afb4e90b7cccedaebceef.png" src="_images/dfc33c02a9666db56e0e4777b805a202ac88503a5f8afb4e90b7cccedaebceef.png" />
<img alt="_images/0368ba6b88039ad2d2dfe751a2a226d4b601b8314fb3b28b309712e20de15faf.png" src="_images/0368ba6b88039ad2d2dfe751a2a226d4b601b8314fb3b28b309712e20de15faf.png" />
<img alt="_images/b58c9d6d33eb4bd52efaf6fb17eb7ab7e242fedf14d0aa1c43d862b233ed8e92.png" src="_images/b58c9d6d33eb4bd52efaf6fb17eb7ab7e242fedf14d0aa1c43d862b233ed8e92.png" />
<img alt="_images/794317cdf5fa7a1fc90ed6f35cd19e403bcee84e185b4ce473fb1384f7999dc7.png" src="_images/794317cdf5fa7a1fc90ed6f35cd19e403bcee84e185b4ce473fb1384f7999dc7.png" />
<img alt="_images/4ccd0069866546c40fedc9ad08c03ae4ca97acef2cbaf031652cde81d95616b0.png" src="_images/4ccd0069866546c40fedc9ad08c03ae4ca97acef2cbaf031652cde81d95616b0.png" />
<img alt="_images/7cf58ab6af5a99511695055143e8be8cc990005785c19fee93173432ed0f320e.png" src="_images/7cf58ab6af5a99511695055143e8be8cc990005785c19fee93173432ed0f320e.png" />
<img alt="_images/caf7a9219e74442fe658952999ce7ffb8f96e157a5bf9ead8eb6fe6d9b2275c1.png" src="_images/caf7a9219e74442fe658952999ce7ffb8f96e157a5bf9ead8eb6fe6d9b2275c1.png" />
<img alt="_images/632aec7e04268bb1adc3ac7650f4c3cb22e5ca667a8c4d61cd5ad92a792ab0dd.png" src="_images/632aec7e04268bb1adc3ac7650f4c3cb22e5ca667a8c4d61cd5ad92a792ab0dd.png" />
<img alt="_images/fbf7fbc9624c4e353606f7ea7386add3c4f5a9ab0703d74b6001f035d611f6fa.png" src="_images/fbf7fbc9624c4e353606f7ea7386add3c4f5a9ab0703d74b6001f035d611f6fa.png" />
</div>
</div>
</section>
<section id="practice-exercise-for-you">
<h3>Practice exercise for you<a class="headerlink" href="#practice-exercise-for-you" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Try out different values for <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> in <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> and examine the clusters.</p></li>
<li><p>If you are feeling adventurous, you may try customer segmentation on <a class="reference external" href="https://www.kaggle.com/wordsforthewise/lending-club">All Lending Club loan data</a>.</p></li>
</ul>
<p><br><br><br><br></p>
</section>
</section>
<section id="final-comments-and-summary">
<h2>Final comments and summary<a class="headerlink" href="#final-comments-and-summary" title="Permalink to this heading">#</a></h2>
<section id="a-comment-on-initialization">
<h3>A comment on initialization<a class="headerlink" href="#a-comment-on-initialization" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The initialization of K-Means is stochastic, can this affect the results?</p>
<ul>
<li><p>Yes! Big time.</p></li>
</ul>
</li>
<li><p>Let’s look at an example.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f4207a77640&gt;]
</pre></div>
</div>
<img alt="_images/64d2841f321f78540f00902af9168c17b886dff12073368d8c91c41b5b2a3f64.png" src="_images/64d2841f321f78540f00902af9168c17b886dff12073368d8c91c41b5b2a3f64.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_examples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">toy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feat1&quot;</span><span class="p">,</span> <span class="s2">&quot;feat2&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-bad-initialization">
<h3>Example: Bad initialization<a class="headerlink" href="#example-bad-initialization" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">centroids_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">centroids_idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_iterative</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5d1400c05c83b23af6b7cbeee670a107656ed2c741757ed7ee0d225234bd64b.png" src="_images/f5d1400c05c83b23af6b7cbeee670a107656ed2c741757ed7ee0d225234bd64b.png" />
</div>
</div>
</section>
<section id="example-better-initialization">
<h3>Example: Better initialization<a class="headerlink" href="#example-better-initialization" title="Permalink to this heading">#</a></h3>
<p>The following initialization seems much better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">centroids_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">centroids_idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmle</span><span class="o">.</span><span class="n">plot_iterative</span><span class="p">(</span><span class="n">toy_df</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e63190975abd994204d7fc3213586c6c74e373c07bac8bda5cb28dd5816706ec.png" src="_images/e63190975abd994204d7fc3213586c6c74e373c07bac8bda5cb28dd5816706ec.png" />
</div>
</div>
</section>
<section id="what-can-we-do-about-it">
<h3>What can we do about it?<a class="headerlink" href="#what-can-we-do-about-it" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>One strategy is to run the algorithm several times.</p>
<ul>
<li><p>Check out <code class="docutils literal notranslate"><span class="pre">n_init</span></code> parameter of <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">KMeans</span></code></a>.</p></li>
</ul>
</li>
<li><p>Is it possible to pick <code class="docutils literal notranslate"><span class="pre">K</span></code> in a smart way?</p>
<ul>
<li><p>Yes! We can use the so-called <a class="reference external" href="http://ilpubs.stanford.edu:8090/778/1/2006-13.pdf">K-Means++</a>.</p></li>
<li><p>Intuitively, it picks the initial centroids which are far away from each other.</p></li>
<li><p>In other words, K-Means++ gives more chance to select points that are far away from centroids already picked.</p></li>
<li><p>By default, <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> uses this strategy for initialization.</p></li>
</ul>
</li>
</ul>
</section>
<section id="important-points-to-remember">
<h3>Important points to remember<a class="headerlink" href="#important-points-to-remember" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Clustering is a common unsupervised approach to identifying underlying structure in data and grouping points based on similarity.</p></li>
<li><p>K-Means is a popular clustering algorithm.</p></li>
</ul>
</section>
<section id="id8">
<h3>Important points to remember<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p><strong>K-Means</strong></p>
<ul class="simple">
<li><p>It requires us to specify the number of clusters in advance.</p></li>
<li><p>Each example is assigned to one (and only one) cluster.</p></li>
<li><p>The labels provided by the algorithm have no actual meaning.</p></li>
<li><p>The centroids live in the same space as that of the dataset but they are <strong>not</strong> actual data points, but instead are average points.</p></li>
<li><p>It always converges. Convergence is dependent upon the initial centers and it may converge to a sub-optimal solution.</p></li>
</ul>
</section>
<section id="id9">
<h3>Important points to remember<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Two ways to provide insight into how many clusters are reasonable for the given problem are: <strong>the Elbow method</strong> and <strong>the Silhouette method</strong>.</p></li>
<li><p>Some applications of K-Means clustering include data exploration, feature engineering, customer segmentation, and document clustering.</p></li>
<li><p>It takes a fair amount of manual effort and domain knowledge to interpret clusters returned by K-Means.</p></li>
</ul>
</section>
</section>
<section id="recommendation-reading-materials">
<h2>Recommendation reading materials<a class="headerlink" href="#recommendation-reading-materials" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=4b5d3muPQmA">StatQuest: K-means clustering</a></p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ted.com/talks/malcolm_gladwell_on_spaghetti_sauce?language=en">“Spaghetti Sauce” talk by Malcolm Gladwell</a></p></li>
<li><p><a class="reference external" href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/">Visualizing-k-means-clustering</a></p></li>
<li><p><a class="reference external" href="http://tech.nitoyon.com/en/blog/2013/11/07/k-means/">Visualizing K-Means algorithm with D3.js</a></p></li>
<li><p><a class="reference external" href="https://dashee87.github.io/data%20science/general/Clustering-with-Scikit-with-GIFs/">Clustering with Scikit with GIFs</a></p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/clustering.html"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> clustering documentation</a></p></li>
</ul>
<hr></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="14_unsupervised-learning-pca.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Unsupervised learning</p>
      </div>
    </a>
    <a class="right-next"
       href="16_dbscan_hierarchical.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">DBSCAN</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-name-lo-a">Learning outcomes <a name="lo"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-motivation">Clustering motivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-clustering">Why clustering?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-and-possible-output">Input and possible output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-notion-of-correct-grouping">Is there a notion of “correct” grouping?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meaningful-groups-in-clustering">Meaningful groups in clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications-data-exploration">Common applications: Data exploration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications-customer-segmentation">Common applications: Customer segmentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#document-clustering">Document clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#similarity-and-distances">Similarity and distances</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-algorithm">K-Means clustering algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstration-of-k-means">Demonstration of K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-visualization">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">K-Means Visualization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-using-sklearn">K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kmeans-fit"><code class="docutils literal notranslate"><span class="pre">KMeans</span></code> <code class="docutils literal notranslate"><span class="pre">fit</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-of-kmeans"><code class="docutils literal notranslate"><span class="pre">predict</span></code> of <code class="docutils literal notranslate"><span class="pre">KMeans</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-centers-in-k-means">Cluster centers in  K-Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-predictions-on-new-examples">K-Means predictions on new examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-algorithm-main-idea">K-Means algorithm: Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">K-Means clustering algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-process">Iterative process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-the-closest-centers">How to find the closest centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">How to find the closest centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-update-centers">How to update centers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-1-step-1">Iteration 1: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-1-step-2">Iteration 1: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-2-step-1">Iteration 2: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-2-step-2">Iteration 2: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-3-step-1">Iteration 3: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-3-step-2">Iteration 3: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-4-step-1">Iteration 4: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-4-step-2">Iteration 4: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-5-step-1">Iteration 5: Step 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iteration-5-step-2">Iteration 5: Step 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-stop">When to stop?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Example 2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Initialization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-feature-engineering-using-k-means">(Optional) Feature engineering using K-Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-k-a-name-3-center-a">Choosing K <a name="3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-tuning-for-k">Hyperparameter tuning for K</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-elbow-method">Method 1: The Elbow method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inertia">Inertia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-silhouette-method">Method 2: The Silhouette method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-intra-cluster-distance-a">Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-cluster-distance-b">Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-distance-for-a-sample">Silhouette distance for a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-silhouette-scores-to-select-the-number-of-clusters">Using Silhouette scores to select the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-look-for-in-these-plots">What to look for in these plots?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-on-silhouette-scores">Comments on Silhouette scores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-true-false-questions">K-Means: True/False questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">K-Means: True/False questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-case-study-customer-segmentation">K-Means case study: Customer segmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-customer-segmentation">What is customer segmentation?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#business-problem">Business problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-on-the-dataset">Information on the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminary-eda">Preliminary EDA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-exercises-for-you">Practice exercises for you</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-exercises-for-you-answers">Mini exercises for you (Answers)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-types-and-preprocessing">Feature types and preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-the-hyperparameter-n-clusters">Tuning the hyperparameter <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-interpretation">Cluster interpretation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transactors">Transactors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#revolvers">Revolvers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vip-prime">VIP/Prime</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-activity">Low activity</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-the-interpretation-of-clusters">More on the interpretation of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-exercise-for-you">Practice exercise for you</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-and-summary">Final comments and summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-comment-on-initialization">A comment on initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bad-initialization">Example: Bad initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-better-initialization">Example: Better initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-we-do-about-it">What can we do about it?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-to-remember">Important points to remember</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Important points to remember</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Important points to remember</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendation-reading-materials">Recommendation reading materials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>